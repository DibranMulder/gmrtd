package document

import (
	"bytes"
	"testing"

	cms "github.com/gmrtd/gmrtd/cms"
	"github.com/gmrtd/gmrtd/utils"
)

func TestNewSODNoData(t *testing.T) {
	if sod, err := NewSOD(nil); sod != nil || err != nil {
		t.Errorf("Should be nil when no input data provided")
	}

	if sod, err := NewSOD([]byte{}); sod != nil || err != nil {
		t.Errorf("Should be nil when no input data provided")
	}
}

func TestNewSODUnhappyRootTag(t *testing.T) {
	var sodbytes []byte = utils.HexToBytes("01021234") // valid TLV but invalid SOD, as tag 77 is missing

	sod, err := NewSOD(sodbytes)

	if err == nil {
		t.Errorf("Error expected")
	}

	if sod != nil {
		t.Errorf("SOD not expected for error case")
	}
}

func TestNewSod(t *testing.T) {
	testCases := []struct {
		sodFileBytes      []byte
		expLdsVersion     string
		expUnicodeVersion string
		expCertCSCA       []byte
		expCertDSC        []byte
	}{
		// NB expLdsVersion/expUnicodeVersion will be set if latest SOD version is used
		{
			// AT
			sodFileBytes:      utils.HexToBytes("7782064d3082064906092a864886f70d010702a082063a30820636020103310f300d06096086480165030402010500308201120606678108010101a0820106048201023081ff020100300d060960864801650304020105003081ea3025020101042090462cd4824bc24ce1ce77e0e40da503b5f25063e61a78e22c3ac04e49b2024330250201020420113888bddfb89a94522959f3cf41007bb1241e2fdfa585d8f480317eb648215f302502010304205c1c4fa5fd3d90662a92d5c6c7ee94030ae7eed9070a6d8f1db376b268d99f83302502010b04202a1704fa33c5b3a5760eb8b48ff0ff9178e6470dc525b79b13bdcbc95d9d83d5302502010c0420c9673800c44a18a3d6e5300e6ad35ab8737dcdfb9f259e43bcff0c9b6a2d78a9302502010e0420aff8c92133072ed5703a84a5a6f5fe148f02a86b36b2d5876193bd48243cd2f2a08203e3308203df30820366a00302010202086189db18b6ede857300a06082a8648ce3d040303303f310b3009060355040613024154310b3009060355040a0c024756310c300a060355040b0c03424d493115301306035504030c0c435343412d41555354524941301e170d3233303133313038303430325a170d3333303530363038303430325a3054310b3009060355040613024154310b3009060355040a0c024756310c300a060355040b0c03424d49310f300d060355040513063030343031353119301706035504030c1044532d415553545249412d654d525444308201333081ec06072a8648ce3d02013081e0020101302c06072a8648ce3d0101022100a9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377304404207d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9042026dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b60441048bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997022100a9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7020101034200048893905193f315ee2e2f1eee3fd5a496f6637deb3778cfe7cc2f6c7f0682acc795b0290265a2cb83119343544f2bbfe42974159ac77b113dafbee860c2523c06a382015930820155301d0603551d0e04160414e76eaa567acf6568c660c985717c3c8a50bd024b301f0603551d230418301680142692c7e398abfbe35192d3f26e9a317d1fed53bd301a0603551d1004133011810f32303233303530363038303430325a30160603551d20040f300d300b06092a28000a0102010101303e0603551d1f043730353033a031a02f862d687474703a2f2f7777772e626d692e67762e61742f637363612f63726c2f43534341415553545249412e63726c300e0603551d0f0101ff04040302078030370603551d120430302ea410300e310c300a06035504070c03415554861a687474703a2f2f7777772e626d692e67762e61742f637363612f30370603551d110430302ea410300e310c300a06035504070c03415554861a687474703a2f2f7777772e626d692e67762e61742f637363612f301d06076781080101060204123010020100310b1301501302415213024944300a06082a8648ce3d040303036700306402303af7ae31ca6b8fafca6ec51985997f7119fb2e6d20d61b5327d5740109aa310b410bfb44f354e086f207fcab721e69ae023046c68fb7909f994350a2d1c84d1ae5dff8c00de6d86b7891a6cf90ceea09159402e6e2ed3fa548db28d33146319eefda318201213082011d020101304b303f310b3009060355040613024154310b3009060355040a0c024756310c300a060355040b0c03424d493115301306035504030c0c435343412d4155535452494102086189db18b6ede857300d06096086480165030402010500a066301506092a864886f70d01090331080606678108010101301c06092a864886f70d010905310f170d3233303331373133343031385a302f06092a864886f70d01090431220420eb5dd19b9688751461b3e61c9c80f1e848d91eec210048aca6653279c7c37c76300c06082a8648ce3d04030205000446304402202567959c119ee15d14520eab1b527c2bc493253d6733bbec30295af57e3ceb070220614dcea3ba92499e2212b9cd4159758cd49ae240e74b3e20d8d49183ed1feb09"),
			expLdsVersion:     "",
			expUnicodeVersion: "",
			expCertCSCA:       utils.HexToBytes("3082043f308203c4a0030201020202047f300c06082a8648ce3d0403030500303f310b3009060355040613024154310b3009060355040a0c024756310c300a060355040b0c03424d493115301306035504030c0c435343412d41555354524941301e170d3139303930323037313334345a170d3330303130353038353332395a303f310b3009060355040613024154310b3009060355040a0c024756310c300a060355040b0c03424d493115301306035504030c0c435343412d41555354524941308201b53082014d06072a8648ce3d020130820140020101303c06072a8648ce3d01010231008cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53306404307bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826043004a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c110461041d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c53150231008cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e90465650201010362000443c3c6026716e0aa300b3b1933e85a639ac183488c235ecd3c53eab01b91b6d0c6de21870b1ea92e2caf8a970096cf828c5ecb10782c5b9697672a1e51db64883e3ec4aae23002dddc7176c7e994393e3c206dcf513710a82ca2d70ae52d636da382014e3082014a301a0603551d1004133011810f32303234313230393037313334345a300e0603551d0f0101ff040403020106301d0603551d0e041604142692c7e398abfbe35192d3f26e9a317d1fed53bd303e0603551d1f043730353033a031a02f862d687474703a2f2f7777772e626d692e67762e61742f637363612f63726c2f43534341415553545249412e63726c30160603551d20040f300d300b06092a28000a010201010130120603551d130101ff040830060101ff02010030370603551d120430302ea410300e310c300a06035504070c03415554861a687474703a2f2f7777772e626d692e67762e61742f637363612f30370603551d110430302ea410300e310c300a06035504070c03415554861a687474703a2f2f7777772e626d692e67762e61742f637363612f301f0603551d23041830168014ff8dea86af18eee58ba2d6ba8cfaab39a169af5b300c06082a8648ce3d04030305000367003064023060483a073bdaed252cee333223b1c2991c3aa076c52997a5799420a36e8ed0a5299fda764b5cb553191a4e678cd72935023049a5cd9cd766edd953db33f198fedc14003f5b828f9e4a8ee316986594d21f4eb721a81a7c9b153a7088e46035580564"),
			expCertDSC:        utils.HexToBytes("308203df30820366a00302010202086189db18b6ede857300a06082a8648ce3d040303303f310b3009060355040613024154310b3009060355040a0c024756310c300a060355040b0c03424d493115301306035504030c0c435343412d41555354524941301e170d3233303133313038303430325a170d3333303530363038303430325a3054310b3009060355040613024154310b3009060355040a0c024756310c300a060355040b0c03424d49310f300d060355040513063030343031353119301706035504030c1044532d415553545249412d654d525444308201333081ec06072a8648ce3d02013081e0020101302c06072a8648ce3d0101022100a9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377304404207d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9042026dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b60441048bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997022100a9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7020101034200048893905193f315ee2e2f1eee3fd5a496f6637deb3778cfe7cc2f6c7f0682acc795b0290265a2cb83119343544f2bbfe42974159ac77b113dafbee860c2523c06a382015930820155301d0603551d0e04160414e76eaa567acf6568c660c985717c3c8a50bd024b301f0603551d230418301680142692c7e398abfbe35192d3f26e9a317d1fed53bd301a0603551d1004133011810f32303233303530363038303430325a30160603551d20040f300d300b06092a28000a0102010101303e0603551d1f043730353033a031a02f862d687474703a2f2f7777772e626d692e67762e61742f637363612f63726c2f43534341415553545249412e63726c300e0603551d0f0101ff04040302078030370603551d120430302ea410300e310c300a06035504070c03415554861a687474703a2f2f7777772e626d692e67762e61742f637363612f30370603551d110430302ea410300e310c300a06035504070c03415554861a687474703a2f2f7777772e626d692e67762e61742f637363612f301d06076781080101060204123010020100310b1301501302415213024944300a06082a8648ce3d040303036700306402303af7ae31ca6b8fafca6ec51985997f7119fb2e6d20d61b5327d5740109aa310b410bfb44f354e086f207fcab721e69ae023046c68fb7909f994350a2d1c84d1ae5dff8c00de6d86b7891a6cf90ceea09159402e6e2ed3fa548db28d33146319eefda"),
		},
		{
			// DE
			sodFileBytes:      utils.HexToBytes("7782070F3082070B06092A864886F70D010702A08206FC308206F8020103310F300D06096086480165030402020500308201120606678108010101A0820106048201023081FF020101300B06096086480165030402023081DC303502010104302DAFFEB0F67656AE099FD655B32F7DC857C31073DF9BC0AF8C9CC783FB40CD9C3FE7503E07421F560ECD7A09B6133D4E303502010204302C65A444298E8A7C1FE51EDE7F2CDD9B8439597330FE142A1996984F841ED3840EE6FEF3475336D29D94012149D9669730350201030430A668251FB0FFDAEF79FEDBD092A296BD808E79FAE546754D0E7F2C9F3F016F23849DD0B7C74A8752DDA554412A8542CD303502010E0430C87AB92F21166AE1059B7D7D995DCE9CDD3E211AECFB943259D88BB2EB8B533B2B5C780251EB5AD21B0A4A8D8A9EE1A2300E1304303130381306303430303030A082049730820493308203F8A003020102020204A8300A06082A8648CE3D0403043041310B3009060355040613024445310D300B060355040A0C0462756E64310C300A060355040B0C036273693115301306035504030C0C637363612D6765726D616E79301E170D3233303130343036303434325A170D3333303730343233353935395A305D310B3009060355040613024445311D301B060355040A0C1442756E646573647275636B6572656920476D6248310C300A060355040513033135323121301F06035504030C18446F63756D656E74205369676E65722050617373706F7274308201B53082014D06072A8648CE3D020130820140020101303C06072A8648CE3D01010231008CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B412B1DA197FB71123ACD3A729901D1A71874700133107EC53306404307BC382C63D8C150C3C72080ACE05AFA0C2BEA28E4FB22787139165EFBA91F90F8AA5814A503AD4EB04A8C7DD22CE2826043004A8C7DD22CE28268B39B55416F0447C2FB77DE107DCD2A62E880EA53EEB62D57CB4390295DBC9943AB78696FA504C110461041D1C64F068CF45FFA2A63A81B7C13F6B8847A3E77EF14FE3DB7FCAFE0CBD10E8E826E03436D646AAEF87B2E247D4AF1E8ABE1D7520F9C2A45CB1EB8E95CFD55262B70B29FEEC5864E19C054FF99129280E4646217791811142820341263C53150231008CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B31F166E6CAC0425A7CF3AB6AF6B7FC3103B883202E9046565020101036200042CA852CB9A1CAAAA466256D1CFD678BB7E5D8502DFA6F3FDB287293C32AF9FA77AD3A7FA92E56F608110053121354002198B530BC60AC7050AB98D7F6C475FD50706A4A6207D7A6336CB480B966A3AA64894F7F42B8FB4AC4774C9D6892330FBA382016430820160301F0603551D23041830168014A40A5FC380AE3E59AF1B32D6136AEFEEC8CA35E8301D0603551D0E04160414AF9DD5E6565737A8804B5B4C6F45093D809AA865300E0603551D0F0101FF040403020780302B0603551D1004243022800F32303233303130343036303434325A810F32303233303730343233353935395A30160603551D20040F300D300B060904007F000703010101302D0603551D1104263024821262756E646573647275636B657265692E6465A40E300C310A300806035504070C014430510603551D12044A30488118637363612D6765726D616E79406273692E62756E642E6465861C68747470733A2F2F7777772E6273692E62756E642E64652F63736361A40E300C310A300806035504070C01443015060767810801010602040A3008020100310313015030300603551D1F042930273025A023A021861F687474703A2F2F7777772E6273692E62756E642E64652F637363615F63726C300A06082A8648CE3D0403040381880030818402404846F4A03E17896E9094AF7652C38FE31EC964C2C3A906AF813AABEF5FE4F3156D140E2EF991DC11FD860A4A301B225DE9FD4ED39B4F47AC72CDB88CC63B335902405D4E2895875E603CE2863073BF441D1EC53761CF47E5BC2B9B6BECE4F229712E39002D77B555290FA550DF5F40AA22D7D2A1E89FEB3FEF730AE33C937796E8E33182012F3082012B02010130473041310B3009060355040613024445310D300B060355040A0C0462756E64310C300A060355040B0C036273693115301306035504030C0C637363612D6765726D616E79020204A8300D06096086480165030402020500A058301506092A864886F70D01090331080606678108010101303F06092A864886F70D01090431320430C194CBC52AAC7A5077E792739434040CCE0C465DDEBF366D64EB3AB8EF5BB457CF5C4BD3D28F69804E5507308DCAE3E8300C06082A8648CE3D0403030500046630640230403C68550DBC310A8002110EE18AEF04E00B119030E0CC3AC8CAD347D87F59031AF26867F1855B1F1555B7C925B92D8A02307185621CD2CDA6051E81627BE5A486EB667897440F5BD69F96B8DD43F4F0B0A0CD21DF376012DBA79D9F7138C2D9B3C7"),
			expLdsVersion:     "0108",
			expUnicodeVersion: "040000",
			expCertCSCA:       utils.HexToBytes("3082051c30820480a0030201020202048b300a06082a8648ce3d0403043041310b3009060355040613024445310d300b060355040a0c0462756e64310c300a060355040b0c036273693115301306035504030c0c637363612d6765726d616e79301e170d3231313132333036323431355a170d3336303232333233353935395a3041310b3009060355040613024445310d300b060355040a0c0462756e64310c300a060355040b0c036273693115301306035504030c0c637363612d6765726d616e7930820238308201af06072a8648ce3d0201308201a2020101304c06072a8648ce3d0101024100aadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f330818404407830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca04403df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f7230481810481aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f8227dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892024100aadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca9006902010103818200048190956c09b852981dc52949f3463b8efcdfe65e3e5a51d1c0dacf27c75e8252cc0840157a21a97bd9b4c927312afa8ae0ca1ca515f98cc1150f9a768d4d43ef556abcd3564bcaf583f53c6f40918155146dbab57f6cac0ba838010345e3dbc7140d82ea339a5747d48c53f02db42187d320ed4e275c755092750b04fe72ae97a382018530820181301d0603551d0e04160414a40a5fc380ae3e59af1b32d6136aefeec8ca35e8300e0603551d0f0101ff040403020106302b0603551d1004243022800f32303231313132333036323431355a810f32303235303132333233353935395a30160603551d20040f300d300b060904007f00070301010130510603551d11044a30488118637363612d6765726d616e79406273692e62756e642e6465861c68747470733a2f2f7777772e6273692e62756e642e64652f63736361a40e300c310a300806035504070c014430510603551d12044a30488118637363612d6765726d616e79406273692e62756e642e6465861c68747470733a2f2f7777772e6273692e62756e642e64652f63736361a40e300c310a300806035504070c014430120603551d130101ff040830060101ff02010030300603551d1f042930273025a023a021861f687474703a2f2f7777772e6273692e62756e642e64652f637363615f63726c301f0603551d23041830168014a40a5fc380ae3e59af1b32d6136aefeec8ca35e8300a06082a8648ce3d040304038189003081850241009207451b0276c9b0bfe91c3b3fb7594489f6d5c34d4ff11149f1937beccf1a8d3919267b2bcbb176e2b9ecf6a4c240b0e1d0983e242a32e0c160d530db6934d5024037fb298c2da3ef90c70949aec7111f5eedd0a708a936ceab479d357da08c742762a3cddd2d6aa586d6822ebb762cfdcb5db734ee6d7f8ec1ed366305ba1aef0b"),
			expCertDSC:        utils.HexToBytes("30820493308203f8a003020102020204a8300a06082a8648ce3d0403043041310b3009060355040613024445310d300b060355040a0c0462756e64310c300a060355040b0c036273693115301306035504030c0c637363612d6765726d616e79301e170d3233303130343036303434325a170d3333303730343233353935395a305d310b3009060355040613024445311d301b060355040a0c1442756e646573647275636b6572656920476d6248310c300a060355040513033135323121301f06035504030c18446f63756d656e74205369676e65722050617373706f7274308201b53082014d06072a8648ce3d020130820140020101303c06072a8648ce3d01010231008cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53306404307bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826043004a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c110461041d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c53150231008cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565020101036200042ca852cb9a1caaaa466256d1cfd678bb7e5d8502dfa6f3fdb287293c32af9fa77ad3a7fa92e56f608110053121354002198b530bc60ac7050ab98d7f6c475fd50706a4a6207d7a6336cb480b966a3aa64894f7f42b8fb4ac4774c9d6892330fba382016430820160301f0603551d23041830168014a40a5fc380ae3e59af1b32d6136aefeec8ca35e8301d0603551d0e04160414af9dd5e6565737a8804b5b4c6f45093d809aa865300e0603551d0f0101ff040403020780302b0603551d1004243022800f32303233303130343036303434325a810f32303233303730343233353935395a30160603551d20040f300d300b060904007f000703010101302d0603551d1104263024821262756e646573647275636b657265692e6465a40e300c310a300806035504070c014430510603551d12044a30488118637363612d6765726d616e79406273692e62756e642e6465861c68747470733a2f2f7777772e6273692e62756e642e64652f63736361a40e300c310a300806035504070c01443015060767810801010602040a3008020100310313015030300603551d1f042930273025a023a021861f687474703a2f2f7777772e6273692e62756e642e64652f637363615f63726c300a06082a8648ce3d0403040381880030818402404846f4a03e17896e9094af7652c38fe31ec964c2c3a906af813aabef5fe4f3156d140e2ef991dc11fd860a4a301b225de9fd4ed39b4f47ac72cdb88cc63b335902405d4e2895875e603ce2863073bf441d1ec53761cf47e5bc2b9b6bece4f229712e39002d77b555290fa550df5f40aa22d7d2a1e89feb3fef730ae33c937796e8e3"),
		},
		{
			// FI
			sodFileBytes:      utils.HexToBytes("7782088c3082088806092a864886f70d010702a082087930820875020103310d300b06096086480165030402033082019b0606678108010101a082018f0482018b30820187020101300b06096086480165030402033082016330450201010440a0b15e7466598ae774aec55d6aa596cb2febf044e0f0a90466249672312f733e3b57eeb116e020caaba0361479c6e1f099c8c8ca0aa24a9139811b5c5a3e031f304502010204401cefc2c48091a24631b32208ee8c3dcbd8e8a4c8aad87a4a46b89121a8617447f83bc5fd0c11cccf0423d4fae2c1954d01c16f5cd43c0b44b58e87faf3baef0f304502010304407fb5cc189137a7455068a1755439beeff0a889ee0b2eb8808bb6e08d28ad39e2eb01009cae80869293e770a0e47fd651c2771f5a6b672bd9952ec3e5db59b90d30450201070440b3430bb89d0fac56e6ff2a77350926b19f69ba517f3052324f41c09b687ed6c11a92114ab28a9291f8de4845441dacc3c403deac385b431de79435162495b431304502010e04401755b7a48d3394aa84e9ff977be9eb9e6e0c9001ea19341b57001e1963e7554136ea6bcd72dbd7f4942ec868cdbc313e9ac888b6d715191e5335e0e7f295b00d300e1304303130381306303430303030a082055a30820556308204bba0030201020204009eb12b300a06082a8648ce3d0403043044310b30090603550406130246493110300e060355040a0c0746696e6c616e64310c300a060355040b0c0356524b3115301306035504030c0c435343412046696e6c616e64301e170d3233303733303032303030305a170d3238313033303231353935395a305b313a303806035504030c314943414f20436f6d706c69616e7420446f63756d656e74205369676e657220666f72204964656e746974792043617264733110300e060355040a0c0746696e6c616e64310b300906035504061302464930820238308201af06072a8648ce3d0201308201a2020101304c06072a8648ce3d0101024100aadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f330818404407830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca04403df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f7230481810481aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f8227dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892024100aadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca9006902010103818200047104ced432749be70d31cc2282ea2d76e63495f3c23c79a45d3c8deb2f5742b0cf807f863b772a9485759d921e83d6e561232770e35a4ab875ec774193ab4eed64aa980bae6853e2fde8d4af7a7310fdf6e0bfbf8a1e546b9ae52531143214b0d24461ffc427da7ab4a40c8cff50a19d050d37007289069a67ffa9bee53fdf5ca38201a13082019d301f0603551d23041830168014d69f6ca7f2e0ab2c5afaf19e697268364d31d393301d0603551d0e04160414843719d5e6ebeab022f12ffdfee6cd0e6544f87d300e0603551d0f0101ff040403020780302b0603551d1004243022800f32303233303733303032303030305a810f32303233313033313231353935395a30160603551d20040f300d300b06092a81768405020a0502304f0603551d1204483046a410300e310c300a06035504070c0346494e8116435343412e46696e6c616e6440676f767365632e6669861a687474703a2f2f7777772e706f6c696973692e66692f6373636130320603551d11042b302981156549442e46696e6c616e6440676f767365632e6669a410300e310c300a06035504070c0346494e306a0603551d1f04633061302da02ba0298627687474703a2f2f70726f78792e66696e6569642e66692f63726c2f6373636166696e632e63726c3030a02ea02c862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f46494e2e63726c3015060767810801010602040a30080201003103130149300a06082a8648ce3d04030403818800308184024025f44a41c77bbc747f0dfd2eed410a2adb6bd9ba2feffe733cdb4d323ed5a300541b373be7859435256ced64b9cbdc1688fcce1b774cc3b00d7d5a0370a7c8f6024043f7198e91f5af185009711b93d37b6c7119f4bed0014605a906fc837d96c70055667f55cba632b0af45c0286ac36584b3072d9893a5da7e9a3b0c2357abd384318201623082015e020101304c3044310b30090603550406130246493110300e060355040a0c0746696e6c616e64310c300a060355040b0c0356524b3115301306035504030c0c435343412046696e6c616e640204009eb12b300b0609608648016503040203a068301506092a864886f70d01090331080606678108010101304f06092a864886f70d01090431420440a3d4fc4488ad552d1d9def987ac4f52b7c8dde70158d2cf2bd131feac6e4476d9e33e6ee25a196009e1c72334c81e50bef1182db529ffd71f9b7bd6191643730300a06082a8648ce3d04030404818730818402404fc84f664786dd227ddfe2667108a4c20ac51e5abcb44c9fcd82027cb63eba4f0a62aacc21b41bae84f8a04d5efcf0daedf5e6e4d9cb1e71a8f128b4779a471602406d87171b1513b7c4234704eb2e8520a1b11c76f624ef74f99374a9b099525de2db4a1c13d1b9e8641787411808065b8a7af910f65fe52f0aaffd08f2b533588c"),
			expLdsVersion:     "0108",
			expUnicodeVersion: "040000",
			expCertCSCA:       utils.HexToBytes("308205263082048ba0030201020204009eb100300a06082a8648ce3d0403043044310b30090603550406130246493110300e060355040a0c0746696e6c616e64310c300a060355040b0c0356524b3115301306035504030c0c435343412046696e6c616e64301e170d3232303430363036323431325a170d3332303730363036323431325a3044310b30090603550406130246493110300e060355040a0c0746696e6c616e64310c300a060355040b0c0356524b3115301306035504030c0c435343412046696e6c616e6430820238308201af06072a8648ce3d0201308201a2020101304c06072a8648ce3d0101024100aadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f330818404407830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca04403df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f7230481810481aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f8227dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892024100aadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069020101038182000410bd0cb472ca330ff84c0ce076695decdf5a7e520bdac5ec3a316d3cca3501bb20ddc398673a4b6d28e1fc21f8f928e76c4d3a9e96d6ffc179c333a4b94bba6c7980714d2c14165f837c416cce07c2381c1c3db05a9a3d6d8fcb5c3804579e24a6135416311b401dbaeda8bb29ea577dbcd735d9c6df0f60d11715085d84f839a382018830820184301f0603551d23041830168014d69f6ca7f2e0ab2c5afaf19e697268364d31d393301d0603551d0e04160414d69f6ca7f2e0ab2c5afaf19e697268364d31d393300e0603551d0f0101ff040403020106302b0603551d1004243022800f32303232303430363036323431325a810f32303237303430363036323431325a30150603551d20040e300c300a06082a81768405020a05304f0603551d1204483046a410300e310c300a06035504070c0346494e8116435343412e46696e6c616e6440676f767365632e6669861a687474703a2f2f7777772e706f6c696973692e66692f63736361304f0603551d1104483046a410300e310c300a06035504070c0346494e8116435343412e46696e6c616e6440676f767365632e6669861a687474703a2f2f7777772e706f6c696973692e66692f6373636130120603551d130101ff040830060101ff02010030380603551d1f0431302f302da02ba0298627687474703a2f2f70726f78792e66696e6569642e66692f63726c2f6373636166696e632e63726c300a06082a8648ce3d04030403818800308184024037a0b38845297f6b6acc9442dc3f56ae03710b4409745a4196c2871135c18f86279f681767432f131eaf171067cec3f40ebf734d186eae4eb9c251778c64f1e4024036e1eee0ade1c7084834f34e8aaa45c7de85311147c75bdfdfd868ca897e8f66207c060ba8b713b9bcc46380e3c872c912941209188c497e75762259f1e1a1ed"),
			expCertDSC:        utils.HexToBytes("30820556308204bba0030201020204009eb12b300a06082a8648ce3d0403043044310b30090603550406130246493110300e060355040a0c0746696e6c616e64310c300a060355040b0c0356524b3115301306035504030c0c435343412046696e6c616e64301e170d3233303733303032303030305a170d3238313033303231353935395a305b313a303806035504030c314943414f20436f6d706c69616e7420446f63756d656e74205369676e657220666f72204964656e746974792043617264733110300e060355040a0c0746696e6c616e64310b300906035504061302464930820238308201af06072a8648ce3d0201308201a2020101304c06072a8648ce3d0101024100aadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f330818404407830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca04403df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f7230481810481aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f8227dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892024100aadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca9006902010103818200047104ced432749be70d31cc2282ea2d76e63495f3c23c79a45d3c8deb2f5742b0cf807f863b772a9485759d921e83d6e561232770e35a4ab875ec774193ab4eed64aa980bae6853e2fde8d4af7a7310fdf6e0bfbf8a1e546b9ae52531143214b0d24461ffc427da7ab4a40c8cff50a19d050d37007289069a67ffa9bee53fdf5ca38201a13082019d301f0603551d23041830168014d69f6ca7f2e0ab2c5afaf19e697268364d31d393301d0603551d0e04160414843719d5e6ebeab022f12ffdfee6cd0e6544f87d300e0603551d0f0101ff040403020780302b0603551d1004243022800f32303233303733303032303030305a810f32303233313033313231353935395a30160603551d20040f300d300b06092a81768405020a0502304f0603551d1204483046a410300e310c300a06035504070c0346494e8116435343412e46696e6c616e6440676f767365632e6669861a687474703a2f2f7777772e706f6c696973692e66692f6373636130320603551d11042b302981156549442e46696e6c616e6440676f767365632e6669a410300e310c300a06035504070c0346494e306a0603551d1f04633061302da02ba0298627687474703a2f2f70726f78792e66696e6569642e66692f63726c2f6373636166696e632e63726c3030a02ea02c862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f46494e2e63726c3015060767810801010602040a30080201003103130149300a06082a8648ce3d04030403818800308184024025f44a41c77bbc747f0dfd2eed410a2adb6bd9ba2feffe733cdb4d323ed5a300541b373be7859435256ced64b9cbdc1688fcce1b774cc3b00d7d5a0370a7c8f6024043f7198e91f5af185009711b93d37b6c7119f4bed0014605a906fc837d96c70055667f55cba632b0af45c0286ac36584b3072d9893a5da7e9a3b0c2357abd384"),
		},
		{
			// MY
			// RSA-PSS
			sodFileBytes:      utils.HexToBytes("7782098e3082098a06092a864886f70d010702a082097b30820977020103310f300d06096086480165030402010500308201120606678108010101a0820106048201023081ff020100300d060960864801650304020105003081ea3025020101042070d01631abbf347f1fb7ca0b7e8fe6468b84fae853cb7fab2a2e05ef1519c58c30250201020420470beea11e946390967f3521407a29e258179661d6857e8a7d87a5afe9f23cb4302502010304204aea153d17588f1b22a886762789f911abd3ed9017e2d9a150967c70b6c61036302502010b0420a96b4199a460644233ab19cd648edee9c12c520365084356fb5cbb5f962c9024302502010c04206c00c5168e184d6b94129e79d4fbace2a0b4837b7ae196327cf7a8c567085872302502010e042056139d693f679511a91d67585aac748f0b70ca6e14417c1a73f15f205a03cc14a08205d0308205cc30820400a003020102020869ee7da36620dfab304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572301e170d3232303831363039333731345a170d3238303831343039333731345a30819b311c301a06035504030c134d616c617973696120446f63205369676e657231293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f727431233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c6179736961310e300c06035504070c054a6f686f72310e300c06035504080c054a6f686f72310b3009060355040613024d5930820122300d06092a864886f70d01010105000382010f003082010a028201010098153deed15a97298a0190224b91725d0dbd872bc78da1e88b0a0acfc4d74904d2438be7ce7a0876cd4b50c0edfd3337c9278e76f1be9c3469c8ca45a786923eb73c044e2940a4dfe8dee5eb5d9ac46a2297d737a13ab6243418ad2ac2642a5858b79c6d494dcd835d9b8f32eae830c330c375530fb9024126fb050e03ba9c2addacfd7e3df1805c00a8d5aa55811f7f5ebe29cd2442c5e4cbc640468bfdd5b660ef5434e1cba0ad713886ba14acc9ffc3eff47d54b063bb97d2ac19eea1c00d5389b61dd8aeb249e010802d9f2923a56aedf54fd86011a07e89882e84b631588b94dafd3f0d638134ec2bf3335e53162ee1d066f4197f4ec1cc37d252c582db0203010001a38201233082011f301d0603551d0e04160414d63a217ed5886cec8406b8b3f161e0d3dc5379e7301f0603551d23041830168014d54dcf907ed448d2f40e059a3932b4660c9ec2db302e0603551d120427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d59533015060767810801010602040a30080201003103130150302b0603551d1004243022800f32303232303831363039333731345a810f32303233303832363039333731345a303b0603551d1f043430323030a02ea02c862a687474703a2f2f7777772e696d692e676f762e6d792f696d616765732f7064662f636163726c2e63726c300e0603551d0f0101ff040403020780301c0603551d110415301381116a696d706b6940696d692e676f762e6d79304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a20302012003820181004a8caeeb0558a5c763262b003719e0d4cbc90ff6ed105af2793eac441f4a6cee1b78be1f4488e2439163ff5a708e50189a1a7d7fe6868ef7bb6c1dd1554cc322c94cc4f02ee9058c0a77a2a2aa5261a9f4fdfacf9fa68337aeeedfa33cbcf2a789887c1c7932cd59bb473d6a9c8f999819385d6517a2412696110514ab63a58672ddca1db5654a818b6714692008ec8da37793b759c222534f0d63cbacf6e9e8afe60ef70fe69ee9c83125710392c31dba5ed553b879a5b66fa2119ac4ef37dd43902b70dde59073b97ae5b5a111a7df3fcc3f471aa64927ed4adc8feb3d77036d16cb9a24e6692c0df7b4e4ae66b6b65a0f5caf036b4ecc432ef5326f29fa047a386390136a0f618e114a235a4db556dc9fc28f46553df18f315bcd611e8f790135ca5dbcc4cbc128bbe5b185925825558c67637c3f2f2586ae03b3f82238d9058b083d2aa1ebba422f7aa0344614a4f0c182383889097813f0c4b760b44272b1b387de5c4dda19d03a7f636f9e8843df927e04ac3667db6a3d456cadfd919b31820275308202710201013081ad3081a0310b3009060355040613024d5931233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c6179736961310b300906035504080c0257503112301006035504070c0950757472616a61796131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572020869ee7da36620dfab300d06096086480165030402010500a066301506092a864886f70d01090331080606678108010101301c06092a864886f70d010905310f170d3233303132343036313931345a302f06092a864886f70d010904312204202ce83a982160f9753ea1a0d8d82f59c0ec9e40647d0015a702823143989a7eb6304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201200482010096e3cb962a1d8cf79787783bcaa26cd80d2fed9282f97cd1f4a2a64f9170d459dc71e9d9a6f9a9eb259f0ef0bd064d3e17bc4c7bed1eeb4e8b73615f1335e1eab147f6bdd2d510afd3dc09b9dd36eb27db96a76045fa56acecbc1d4d5ce66df2a10d3ed3a9fb41d7c6d221a4568e74d496410c8c024006c7d6a990b2c5c8193b03f45c8a9fe11c17c9367ce7dc13c7813fe1abc9a79df39182bf76ddd6de44717ea6a5d3abcfb4c1c6e617543afa53d12719671590b4f48cd75e7ce79698237f3c589f7b224215fc11e97d19b0bd40c769898dc0701675dddd0bf129b5bfebda4b68d11a96cd073ace5590f63d1dddc2abd0970e6ea95a04792b1af82cc7195f"),
			expLdsVersion:     "",
			expUnicodeVersion: "",
			expCertCSCA:       utils.HexToBytes("3082066030820494a00302010202083c99dfd4c3f358e8304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572301e170d3139303732363131303534355a170d3239303732333131303534355a3081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572308201a2300d06092a864886f70d01010105000382018f003082018a0282018100db239b51311a1f69c5b920d49206e21a4124ee424e2321f2f46088cef957980cdfcf1e44433b9cc611f484b7328dea3dfe75874d46dc7659b2a0c866aca5420b32b7db7becccb5f912fc801e00e09e8752164ea64f14fe8fe9cef2ab55c5fc6ebe80c272bf4be881ba5dfd874eef8a357bba2bf62674e24a688b206799b6bf123f96159659250edbd9402d0975355228c2e6670e9bcc40a81b85e157172e8d5a89abd2808664cd30ce4579802a18ae0fe53304e9352733d1ed4c726733d2e91efba5d51ac8f490c81b5419a8b21042da9f61e54cdef133a6e7ac7a59502e1706010b86eda36ac70d00d933b2ae214be0bd2741da0c39457a05952a1ed789d53f7d10c54a95085f38818f9ab8bcdf7c13b39f0efdf3eaba2cdae94f603f07753ab12a792541fa8fef37299af35ca4ab3115b01d9dbd733486aa0de86b88048dc8aa85892e18b3816be3ba4461adab881662049fc0be17ed3a1ece887ca408cd2abd1547cbf5f89cbc923d562660d48df541664b0334edbc3fd59ef9242c6beaf10203010001a38201323082012e301d0603551d0e04160414d54dcf907ed448d2f40e059a3932b4660c9ec2db30120603551d130101ff040830060101ff020100301f0603551d23041830168014d54dcf907ed448d2f40e059a3932b4660c9ec2db302e0603551d120427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d5953302b0603551d1004243022800f32303139303732363131303534355a810f32303234303732343131303534355a303b0603551d1f043430323030a02ea02c862a687474703a2f2f7777772e696d692e676f762e6d792f696d616765732f7064662f636163726c2e63726c300e0603551d0f0101ff040403020106302e0603551d110427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d5953304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a203020120038201810043aa8bb4d713ed1ed41d8b935878910df7d5a5918a8f3f9335be154ba93b1f40f0fbcc278dd20bdd37c917f794041a929cba38cd6c19621fa3120d6c22661672232c2f23c43871d2c42c9e691f8f338e4b8587df5aadea8787a4117ff568929361228940dd74d851d819c46db28286ac56bf927e22a103d8985a8366249206807f0ffbdcf8124983f3d12070bf983301536b4cc211b5f3cb41927c2cb39a8e3710491cf37387e6be0cdba99ba0278d4882ae7b5d4b904b0f920cf04d4b9a2f47aebf74735c6a0916cfb23f039d4085f9c75f67c2d1effd1ef4fe70ad6ad20d217de4f953fee9a6cffa5726a3681ceec689fea7d3b809158334f2e6ca084427821cf93031ecdd8f54bf235975731b5bace0b89be42c2b3f13cf569c11ba4a5455ac77a5a8ab7734db792505eed5485f9668d1827375147ee2c13eb685986ba041221aa3a666e22aa7f8b3ed6fe4ec47363fa28a2c3462b10ff15bcedd80f9d7a1dc7639cb03d4af4f21e16abee3733a949741f1d46bd35222156ee2d015c2c534"),
			expCertDSC:        utils.HexToBytes("308205cc30820400a003020102020869ee7da36620dfab304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572301e170d3232303831363039333731345a170d3238303831343039333731345a30819b311c301a06035504030c134d616c617973696120446f63205369676e657231293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f727431233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c6179736961310e300c06035504070c054a6f686f72310e300c06035504080c054a6f686f72310b3009060355040613024d5930820122300d06092a864886f70d01010105000382010f003082010a028201010098153deed15a97298a0190224b91725d0dbd872bc78da1e88b0a0acfc4d74904d2438be7ce7a0876cd4b50c0edfd3337c9278e76f1be9c3469c8ca45a786923eb73c044e2940a4dfe8dee5eb5d9ac46a2297d737a13ab6243418ad2ac2642a5858b79c6d494dcd835d9b8f32eae830c330c375530fb9024126fb050e03ba9c2addacfd7e3df1805c00a8d5aa55811f7f5ebe29cd2442c5e4cbc640468bfdd5b660ef5434e1cba0ad713886ba14acc9ffc3eff47d54b063bb97d2ac19eea1c00d5389b61dd8aeb249e010802d9f2923a56aedf54fd86011a07e89882e84b631588b94dafd3f0d638134ec2bf3335e53162ee1d066f4197f4ec1cc37d252c582db0203010001a38201233082011f301d0603551d0e04160414d63a217ed5886cec8406b8b3f161e0d3dc5379e7301f0603551d23041830168014d54dcf907ed448d2f40e059a3932b4660c9ec2db302e0603551d120427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d59533015060767810801010602040a30080201003103130150302b0603551d1004243022800f32303232303831363039333731345a810f32303233303832363039333731345a303b0603551d1f043430323030a02ea02c862a687474703a2f2f7777772e696d692e676f762e6d792f696d616765732f7064662f636163726c2e63726c300e0603551d0f0101ff040403020780301c0603551d110415301381116a696d706b6940696d692e676f762e6d79304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a20302012003820181004a8caeeb0558a5c763262b003719e0d4cbc90ff6ed105af2793eac441f4a6cee1b78be1f4488e2439163ff5a708e50189a1a7d7fe6868ef7bb6c1dd1554cc322c94cc4f02ee9058c0a77a2a2aa5261a9f4fdfacf9fa68337aeeedfa33cbcf2a789887c1c7932cd59bb473d6a9c8f999819385d6517a2412696110514ab63a58672ddca1db5654a818b6714692008ec8da37793b759c222534f0d63cbacf6e9e8afe60ef70fe69ee9c83125710392c31dba5ed553b879a5b66fa2119ac4ef37dd43902b70dde59073b97ae5b5a111a7df3fcc3f471aa64927ed4adc8feb3d77036d16cb9a24e6692c0df7b4e4ae66b6b65a0f5caf036b4ecc432ef5326f29fa047a386390136a0f618e114a235a4db556dc9fc28f46553df18f315bcd611e8f790135ca5dbcc4cbc128bbe5b185925825558c67637c3f2f2586ae03b3f82238d9058b083d2aa1ebba422f7aa0344614a4f0c182383889097813f0c4b760b44272b1b387de5c4dda19d03a7f636f9e8843df927e04ac3667db6a3d456cadfd919b"),
		},
		{
			// NZ
			sodFileBytes:      utils.HexToBytes("77820852308006092A864886F70D010702A0803080020103310F300D0609608648016503040201050030800606678108010101A080048201003081FD020100300B06096086480165030402013081EA30250201010420C34B96088C91A4B07DEEC841D55A886B51E1C7AFD79F058F42171FA498F95F2430250201020420C2BFB7E9B14CE960FE1AC3B455913624D1E1ED4AB92E6E2D20A69EC986116787302502010C0420022FFD5A0A871EC28947EC940FB279FDBCB4B25EF03465E653BCD3DD5C370A5F302502010D0420FDD73AEF84C4F9FC4AB807F2EFADBD013452F1EE7200287ADDED53EDCC5D2BB7302502010E04203C8134CF5A985863519B68BD8FA5EE2EDCAD7C375247393E02D84C0DBD7939D3302502010F0420A5ED6C2A093E548A30F0BEF91AC4C07D12E5733DF252AF1E24FCED0ECE56BF9900000000A0820503308204FF308202E7A003020102020442E57A41300D06092A864886F70D01010B0500306D310B3009060355040613024E5A31223020060355040A0C19476F7665726E6D656E74206F66204E6577205A65616C616E6431123010060355040B0C0950617373706F72747331263024060355040B0C1D4964656E746974792053657276696365732050617373706F7274204341301E170D3137313030313230333935365A170D3238303231323131303030305A307B310B3009060355040613024E5A31223020060355040A0C19476F7665726E6D656E74206F66204E6577205A65616C616E6431123010060355040B0C0950617373706F727473310D300B060355040B0C044D5254443125302306035504030C1C446F63756D656E74205369676E65722032303137313030323030303130820122300D06092A864886F70D01010105000382010F003082010A0282010100C0287BDE6240E37AEC9741D64947758B2BBBCD58A87429442FA6C14EE6481F94D2A221352E663D4C1EAEC896F18C235160D47B548E5B445948C976614D263C6568EA9D08EA504FD930D9775D9CE82A3A834C4EFDE2D6BAB04C499045A3C25DCF29C8E9BA4C58958300C687323066A2AD9EA54C8A23D4AA75DBCAF0AE5CFC8176A94B891AD97C328CA03186C1151D4EB3DCBBCABEF8A9F77F50959BFE30891605A7725BF6DE59240DD1818C6CBD4B71C9A41C8D0A8C77ECA1559B3CA124A09F75BB44178A17E29D5C871DA0DC5A50DAD2873321FDEFE8374ABFE41FB0FC2CC2CB4F255AA5FB3D614B18FEE3FE3346C8E0F9F73DE66348E011A17BE8851C59D3250203010001A38198308195300E0603551D0F0101FF040403020780302B0603551D1004243022800F32303137313030313230333935365A810F32303138303231323131303030305A30160603551D20040F300D300B060960842A65826C010101301F0603551D23041830168014F9D6C969FE97D184EEF2C1D7E520B66032BE3DF7301D0603551D0E0416041424757F42B10EE096409789FFAD2D9150ECFDC5BE300D06092A864886F70D01010B050003820201000D64025FB39BBB1606C76AE6211DD773B0B02675D079EBC3283A8E84C763024471463272B2DC389DB2CB282A0931BC57627B9F4FE774BA031C97F371FA9A50FDB0F363FE85786DDACC3E3264317312BC538116D1664A84B641E8260F23DD6B8D5EB42399B2EA944EE20DAFAA074CAFC9F93FEBAEA4D17C8A2DE3200A335BA3260D594A85D85DB9C5D2391FB9190F4BF30835D1E9965EB22FB35D7E8380A7BD014F9757E4D4934F548D47E35B878FC2C7DC411C01EA54EB33CB0B91EC88D91B67B45C30B021F6D9A866000A80686047C8365B1B81099FCAB5AF3642993498BC8B667812872319ED6395C39D4183C21BC1CD7BFE5381479775AFFA8CE9B2DE8347C4623382320BBE4466D700941175A0802AE0182EC882FF26C5351B754270C3129895A58E659690774C5C175B9903A33FB111D10F856F6D452F3D58A9BCBB414CF3017F803E718470007120C65255AEFFF526A15297B5191A1EBCCEB63680039C5B04D08EA739DF0628EA109B42F87411553FBA2BB4A23F64E012F0C7DFAFB5ED7AFE7DC474F87A741E01A03A09AF84F5E7F5CA15A0114C377F6B0012DF83F9E694E839D190658945BF7014FA69E5CC6AE75C96DD3AB98CE636D9EF42A80D5A24EC3D83C6E1195E2EFCD63B335DBD32717F71858D50998C383291D530F1BF8D5C7ECF674A1F200F989D2589FB6A634666EEB9E33441ABDB060DDF0576420F4D0A31820208308202040201013075306D310B3009060355040613024E5A31223020060355040A0C19476F7665726E6D656E74206F66204E6577205A65616C616E6431123010060355040B0C0950617373706F72747331263024060355040B0C1D4964656E746974792053657276696365732050617373706F7274204341020442E57A41300D06096086480165030402010500A066301506092A864886F70D01090331080606678108010101301C06092A864886F70D010905310F170D3137313131353030333631325A302F06092A864886F70D0109043122042071CB0413DAC76278E04BF30A3DF13AFC0D706E3C95CCE1D16250B6AE3694EEFD300D06092A864886F70D0101010500048201003593195E884103297DFE628DC10230063BCEF6EDF13369499ECE259AE1F70C1A59CCE9F1B444B2F9D12C7C2C877D7BE1B81B61A36827862A596853412D1849CA36E6E5DE095C7A8D505784955AD321CBCCBE7A6F5172BC26E32C9F01C8C5D7CF38CF33AA53A4E174CBC86D5E18A9312A2D5377027A274D002A5AB4F5FEDFB3CC5AF9EB4B7D6158A8BEF16A627BE88058342683699E72B3E2F35F5A7E41451D458AE92A6D26DA693DF4BD4D9D8A498A07323934FB50C9B9BCCA013E98E872937AE3875FBA6665E3B92CF22F33A1087C5CB655724A1FFF183F4BE5980E3BC19A46F9656EF81AD2ED6EE3F0E74DC91EC71C1A82FC1DB4E1ED8DD5EEF9A6361CB849000000000000"),
			expLdsVersion:     "",
			expUnicodeVersion: "",
			expCertCSCA:       utils.HexToBytes("308205ca308203b2a003020102020442e578f1300d06092a864886f70d01010b0500306d310b3009060355040613024e5a31223020060355040a0c19476f7665726e6d656e74206f66204e6577205a65616c616e6431123010060355040b0c0950617373706f72747331263024060355040b0c1d4964656e746974792053657276696365732050617373706f7274204341301e170d3135303832353032333131325a170d3239303332353033303131325a306d310b3009060355040613024e5a31223020060355040a0c19476f7665726e6d656e74206f66204e6577205a65616c616e6431123010060355040b0c0950617373706f72747331263024060355040b0c1d4964656e746974792053657276696365732050617373706f727420434130820222300d06092a864886f70d01010105000382020f003082020a028202010099e05fc77700645190a1e6f99f7a0f06e57d724672df439d36076d60ca874cc367b76a62ab995c18f3d30cbc9b6c46e9c9968779d69bdf9b1a6d2b62bfc70a778252b93cf3d775860f467fe8a9ef28ec9fad291930ac777fda3e7a80dba25d8dee25995db764f9a17819a743feb9113a10b45742eb424e27ef58e9b000fec2f04e7c29b6e60a98b32f28db8792e63705261d5411c0cad03d4587b42b1d9af6d5e560d5b77383abb85abb65db4876e5e21670d19f0cceda4cff3aaae94c5b76a572fc9d83f62c5841cf7fafa43a432acbef83f0b41121a3ee853c9506bcb4310d727aeee966f3542d0709c0baa1b9dfdd94d0007b708c424c8ed011fdf80631649ffe54b49b4200fb4cfc159b6223bf46168bd04fc21a481a36966590efd96afb3639d119d84b4b97f7d97c10c0d58c324187156ef297f2e905b22df527e2f850e377eb8ca71d08c8b08a7b8e987ee47e5d3c1fca3f4ae20382b211622aaa779a86b604706d7c6862fec5bd2fe1add329c31a55d6579fb580b53dc2144887a3a710851f9d24b402918bbae9ab19f2471c15a6ea1b6e95ceec1aa3365ea1792ae7231ff07b84e49a9c99ae929035762ee192b96997e3b35a8c646c53259db9c31b4c719c08ad232f557bbec88ab10b8cf528b1046c5ca5905f8c55247af44b4454141f64ed5577b3b53edadd0a34cbbba5d7880b16108e69442def973a8a5be2610203010001a372307030120603551d130101ff040830060101ff020100300e0603551d0f0101ff040403020106302b0603551d1004243022800f32303135303832353032333131325a810f32303138313030393033303131325a301d0603551d0e04160414f9d6c969fe97d184eef2c1d7e520b66032be3df7300d06092a864886f70d01010b0500038202010093de9b9e1e973085029b609a3a7d9fe8d48c6f1dfc9205e3df0f9b310203cfc254d5405a0c7472dddd1e2bb14b5f505bf9dc8d20c48585758aa6f1e0b0d6061cdd04e6a01987d8b9b58f2622bc97066e19d46db7547214803984e38152fed4decb511a9380f79fe01d7e99c358221b4a4be892bd15c36e468afe1ad9ef405bdb1112aeae4a2851e389145b13582f8fee14e6b246329acba1e9cc78dcb038fbe1412b164f9b75ded28d3f8e659f58658334f81479aba8eb2de0c959e494ad69b2c37fbc3e98fab8ff6d86cbe88fb8aa88b4651afea90722a75329e896685bbe9da15d4ccf58a2380bcc1b80fad084761fd2a986bc5c7335893226402a13d930fa812604e1c9b60277f853a6e2c827a9d2f06b3cdcab8336e5a073cb0793e6e9662b7c8c8a85caf93447d34b74f0fffcfddaa268ceb28e8d7c4960304bba52f94d33dbc01d2ccc62658bc1031e5abd7854fc55558df09e0185831288c1156eb823297070107b840635913b171f7bb41643665235443dc67a4675ce60564b14ec90ad4ac9e48249373fe32a89bdbc499a161e5e5bf8080d488faf13d4e047a6a96445dc812b7b0d58244ddfe2c83464fe00d47c15d33ad36f6b196d4a91d8934c7a3941667c04c16db2b0b1039cc305f68f26dd20fb2f818e6f59410708e4d89b9bf98f94a8f08434fcf1a4a42d8e2431b5f63b6ea97b2176a7c8def3ab0a764ffa"),
			expCertDSC:        utils.HexToBytes("308204ff308202e7a003020102020442e57a41300d06092a864886f70d01010b0500306d310b3009060355040613024e5a31223020060355040a0c19476f7665726e6d656e74206f66204e6577205a65616c616e6431123010060355040b0c0950617373706f72747331263024060355040b0c1d4964656e746974792053657276696365732050617373706f7274204341301e170d3137313030313230333935365a170d3238303231323131303030305a307b310b3009060355040613024e5a31223020060355040a0c19476f7665726e6d656e74206f66204e6577205a65616c616e6431123010060355040b0c0950617373706f727473310d300b060355040b0c044d5254443125302306035504030c1c446f63756d656e74205369676e65722032303137313030323030303130820122300d06092a864886f70d01010105000382010f003082010a0282010100c0287bde6240e37aec9741d64947758b2bbbcd58a87429442fa6c14ee6481f94d2a221352e663d4c1eaec896f18c235160d47b548e5b445948c976614d263c6568ea9d08ea504fd930d9775d9ce82a3a834c4efde2d6bab04c499045a3c25dcf29c8e9ba4c58958300c687323066a2ad9ea54c8a23d4aa75dbcaf0ae5cfc8176a94b891ad97c328ca03186c1151d4eb3dcbbcabef8a9f77f50959bfe30891605a7725bf6de59240dd1818c6cbd4b71c9a41c8d0a8c77eca1559b3ca124a09f75bb44178a17e29d5c871da0dc5a50dad2873321fdefe8374abfe41fb0fc2cc2cb4f255aa5fb3d614b18fee3fe3346c8e0f9f73de66348e011a17be8851c59d3250203010001a38198308195300e0603551d0f0101ff040403020780302b0603551d1004243022800f32303137313030313230333935365a810f32303138303231323131303030305a30160603551d20040f300d300b060960842a65826c010101301f0603551d23041830168014f9d6c969fe97d184eef2c1d7e520b66032be3df7301d0603551d0e0416041424757f42b10ee096409789ffad2d9150ecfdc5be300d06092a864886f70d01010b050003820201000d64025fb39bbb1606c76ae6211dd773b0b02675d079ebc3283a8e84c763024471463272b2dc389db2cb282a0931bc57627b9f4fe774ba031c97f371fa9a50fdb0f363fe85786ddacc3e3264317312bc538116d1664a84b641e8260f23dd6b8d5eb42399b2ea944ee20dafaa074cafc9f93febaea4d17c8a2de3200a335ba3260d594a85d85db9c5d2391fb9190f4bf30835d1e9965eb22fb35d7e8380a7bd014f9757e4d4934f548d47e35b878fc2c7dc411c01ea54eb33cb0b91ec88d91b67b45c30b021f6d9a866000a80686047c8365b1b81099fcab5af3642993498bc8b667812872319ed6395c39d4183c21bc1cd7bfe5381479775affa8ce9b2de8347c4623382320bbe4466d700941175a0802ae0182ec882ff26c5351b754270c3129895a58e659690774c5c175b9903a33fb111d10f856f6d452f3d58a9bcbb414cf3017f803e718470007120c65255aefff526a15297b5191a1ebcceb63680039c5b04d08ea739df0628ea109b42f87411553fba2bb4a23f64e012f0c7dfafb5ed7afe7dc474f87a741e01a03a09af84f5e7f5ca15a0114c377f6b0012df83f9e694e839d190658945bf7014fa69e5cc6ae75c96dd3ab98ce636d9ef42a80d5a24ec3d83c6e1195e2efcd63b335dbd32717f71858d50998c383291d530f1bf8d5c7ecf674a1f200f989d2589fb6a634666eeb9e33441abdb060ddf0576420f4d0a"),
		},
		{
			// PH
			sodFileBytes:      utils.HexToBytes("7782095E3082095A06092A864886F70D010702A082094B30820947020103310F300D06096086480165030402010500308201120606678108010101A0820106048201023081FF020100300D060960864801650304020105003081EA302502010104206730D98A8FFA85E4043253BD1D22CCAEEA605FBC3701630A0A6D78E5B7112888302502010204208A1DD7AAF89F5422D330D552719823D044F17091250987A03B00CE634F41BE41302502010704204DFF43AA11E6DCEBCC6E1C187B7987C38F4AED160C71CC4103D78711E6060ADC302502010B0420EB46A2387CE76D93B2F57B0190C893A3F363150FB984F701546FF183D1D31855302502010C04202146D2E1AD80677E04C9EEFB7E0E60223A4597023BF230647D514E448B8EA598302502010F04202E10C0E9A1E6F035DF24C220C81B8673F01FEBB7D0A5C80E94BA71BDCC9B69B5A08206133082060F308203C3A003020102020840AD067FA4023A0E304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A203020120302F310B3009060355040613025048310C300A060355040A0C034446413112301006035504030C09435343413031303036301E170D3139313132353136303030305A170D3330303430313135353935395A302D310B3009060355040613025048310C300A060355040A13034446413110300E060355040313074453303130373630820122300D06092A864886F70D01010105000382010F003082010A0282010100D1EFD35613898709BE32888B19BDCA6B59F32A44E69571BC2C607AA4D79AD74B1A3733B3EC8D78FFB1CBFE2F9C799B544E9E0A39CCD47BB0E043F09C4ECBAD089271AF18F28191ED1ACA0D5A4C1646314FA711D5B18CF6C04A212F1062FB3DFA381A748BB29790A166DA9933495CE41B07CA884641449693A3BA131ABFE6F51286BC8E4FA399742C2D047125EC2494C17D575D3BDDDA472263476119B51FD0E1BC5C46C4928C59D4E6D001522EC525A0191821057AE1BAF9EF9426A63577D77917BB97CEC3622C78C1FAED06F659F3BA3A0EBD88DA7698B281D052F845F93098AA644D286F3EB3A1010B6ED6EE4784E7A7260E0ECBCEAD6534750441CCA2B2ED0203010001A38201C7308201C3300E0603551D0F0101FF040403020780301D0603551D0E04160414797455D55B01A403282F3DE09CF06A525865EA72305E0603551D23045730558014E565E5D20737598E3D938FC3581660804399B4E7A133A431302F310B3009060355040613025048310C300A060355040A0C034446413112301006035504030C09435343413031303036820822D9252BFFE6A957302B0603551D1004243022800F32303139313132353136303030305A810F32303230303430313135353935395A30390603551D1104323030811C70617373706F72742E6469726563746F72406466612E676F762E7068A410300E310C300A06035504070C0350484C30390603551D1204323030811C70617373706F72742E6469726563746F72406466612E676F762E7068A410300E310C300A06035504070C0350484C306D0603551D1F046630643030A02EA02C862A68747470733A2F2F706B64646F776E6C6F6164312E6963616F2E696E742F43524C732F50484C2E63726C3030A02EA02C862A68747470733A2F2F706B64646F776E6C6F6164322E6963616F2E696E742F43524C732F50484C2E63726C3020060767810801010602041530131301501302504F130250441302505213025053304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A20302012003820201003E7221D14221DA072B66A06DF3AA5F25AE16D8643CD5B29F4487F45485B1795B15DACF5D4E325239EEE33FBA07BDFF017D0E7F8F14AF31A3F4B497D1390DABA07D9A5C5463A0E3FC0E44500659F1443AD6DB33AE4F93FF9377A7E90CECE5EA3846C51804C0BDE82D836EF5C0CA29FEFB2789B7DEBF5703B1D35B0112809E5A53B6B09DFBA982056B3ECB00E772A942D103EEF9BB8E8B3148A76B08505A01E64593845289C89FB6C78F111810C441EB8D4B2B17639B13B7F94B704BDBB38722513CC823633E3228A7C2E5FEE76264D1DA831354FD2F7171043B6A9398E5FADE72A7BB024EA9AD7CBB3232E72400E7AF39EB86100A036A3311336C40038E0D0AD0109F10107A827B627CDD367454277078B713AEE9AC3B80B65E0BBE995ED0328E266314313AAFA3234A845AF8C4E39F824718E7CD14B726F29DB76B1C57DD5A34526E446F3A54FD570CD228DA79EC65EB47597348D8FB06F1109DC88F09192F65F0894879602F52AFFE0F03550ED04DE061A57D81F6FB3D03FB2F323FC36A9F3CE6F9C57E919205526797E1CB7D46DDD9CE7EA56C87E7C4740FA0B88E52B9E47D54A798888E769419A98C9A6AFA6F9E5B43314A9FC1F849071338E8D64F6FB7DAA45DCE179C72DB8443730B60D20A9CA210C3E6FFA3BEA954114225AC8CB3395E0B3081AC0652D4AC4EE4F86BAC8F1C099614159C761643D3C7024F038F874ADB31820202308201FE020101303B302F310B3009060355040613025048310C300A060355040A0C034446413112301006035504030C09435343413031303036020840AD067FA4023A0E300D06096086480165030402010500A066301506092A864886F70D01090331080606678108010101301C06092A864886F70D010905310F170D3230303230363039313735345A302F06092A864886F70D0109043122042034C8890E17FEA8825214B0C5EBBA4CCEEC2A3D38891865104C22FC86D95A7A6D304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A20302012004820100A4835931B55868D2FA2951918254AA348A0F31F8375508FAFBAA8807100D85478537E97F001012F520A6964B48226D0AA28700667B95EBCA15730680CDA7D44F2A26F53BA18A357F20BD07E2AB6D6D7227CD58150E292BEE1BBFA2F684135A58F7CAE5DEC092166212E2E633706A059CD83EB9FF5F8C996912E2E91C499C606F8AC6FA66AC957B37F89648C061AD1F006E3715CE4DCA3B4C3416D23B53D88A49C30D9AEBAC5D70B0AD73D9821EC912CDAFD89A62E675007F0BB914AE74E19CED2FF6417520614DB6AF6859EEEF9918685D8629F82C3E8B5E59616D17ED89A2BF7ADBBFD07AC648541CA31A9C10CF03D50D2B572C8298F6D8238408EC0C01FA38"),
			expLdsVersion:     "",
			expUnicodeVersion: "",
			expCertCSCA:       utils.HexToBytes("30820712308204c6a003020102020822d9252bffe6a957304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a203020120302f310b3009060355040613025048310c300a060355040a0c034446413112301006035504030c09435343413031303036301e170d3139303631373136303030305a170d3332303730313135353935395a302f310b3009060355040613025048310c300a060355040a0c034446413112301006035504030c0943534341303130303630820222300d06092a864886f70d01010105000382020f003082020a0282020100cda5dd31a8bfbcad0388c92fe230293e1588e53364f36baee28893ddf38c68e6f482f7ae46b78ec7c01352a388fa014b874ef9cfd788ccd4184cdc1967fe452797dad46abb912be1268c0f43633d03041d31f93235425a34059d0492556064544cad3f5005e2fc4ce955dc4e511470cc9546401ac34b3d2c6b9144b2fc28397f056b1c86379be40f02baedf374a100158e50a774d63c4f651de59fd4b9a0978698574a27dec00e55f350e4ec1d06ffadd55a49c397cb85180ed79ccb8d85322eef67c1c41237303ef90998edcc36aca97af1725677305c94ecefba68ac999669643beec811d2ab673fae3b6b222c3557debd78f8daf008fa54c751ae5c9aee0885ca940eac8282a2bde4730b0d0cf87bab8532c5aee46a6c7a34ec361cf47e59c55359ad7657d771f4a63d1be8601a453a708ac7fa0e9925705a78b0c321c232d79c346dc25d6596d6d3d58f51dec8b0bfca75300ee63f1bb3ea8cc6e8da7473cff85bdebf4e2aebf27603738b9741d90ea904499ebcc870101d4ae7902fdf8c94e264c0c3c619834e19af0f369d0104103a4073f7c81cc1924f39a758e5b8ac8a37d612fce7282232e6b44b23c04aae892efa4d5b2fd6846b32815b9b0e08852f532750ecf8a13342664affce974dda8ddd6873ddc0d647edec2a1de530c884b26305e1d135e1f48f5010e297dfbca05dd861e9c6b2f195128c8abb60deb6850203010001a38201c8308201c430120603551d130101ff040830060101ff020100300e0603551d0f0101ff040403020106301d0603551d0e04160414e565e5d20737598e3d938fc3581660804399b4e7305e0603551d23045730558014e565e5d20737598e3d938fc3581660804399b4e7a133a431302f310b3009060355040613025048310c300a060355040a0c034446413112301006035504030c09435343413031303036820822d9252bffe6a957302b0603551d1004243022800f32303139303631373136303030305a810f32303232303730313135353935395a30390603551d1104323030811c70617373706f72742e6469726563746f72406466612e676f762e7068a410300e310c300a06035504070c0350484c30390603551d1204323030811c70617373706f72742e6469726563746f72406466612e676f762e7068a410300e310c300a06035504070c0350484c306d0603551d1f046630643030a02ea02c862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f50484c2e63726c3030a02ea02c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f50484c2e63726c300d06076781080101060104020500304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a20302012003820201006d8c67b729d7e93d4078b868417ecd192facf25e2f0b20809d406612a7766485cbd7a67d3f3a30541e9c31ccb9c33e73ddba9194785c4fefe505ff03d405c725ee5c41385c987dce613012123b18e8ca7c91a6ee99c212e074827045dcf05fec8efac14868da3cb51ab6efcf25db7b75c193504e50e4d4ac2f86f952fd059e6058060d7d5fb4ce9c3300af8925f8b0ab03ab00729bd29b5e42883a9f75b2e116b9907ddd47b36b070475b2c938759a900a31ac2673f4603aa09ce2d14e43a923ef321873d58d578678e280b35ba952aae5cd99b1035f0046802cebd88566825edb01288fca6fe30af7084285c12412fb07a9fca776396a0e8eb0601244102d13c19037173b5904d5acf59d21c9719f9155bbaa3fe961799f2cfe8d951d40e9cbef37f3ca5986a06eaa45c3cfa3d0280af804df0babe18d75a72aef60c0f612d3dbfc5df04ff916085e3bbe780ac80c05b8fcc5a8a403fe86683365c9b2016ef8aff8623faa865252fe7596ed6231bf3e24eb82605e21e9ee2db6b15783a501dd997fc92d85110e3131d405f4507067f4ad5207d91757f49f8ba5a1ebfd5172b9f0c74db46f109e48271fc9392d775782eb95c9f56579876e64cf049c0da46225e534836af2aa2ac0fbcdcce577acd089ac05f2c460a2328797c08ba3d0e508482eb899108717c81ef71543e3cc89cb4cd35e0f5b1ac3cd5b6df54353bfae60e8"),
			expCertDSC:        utils.HexToBytes("3082060f308203c3a003020102020840ad067fa4023a0e304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a203020120302f310b3009060355040613025048310c300a060355040a0c034446413112301006035504030c09435343413031303036301e170d3139313132353136303030305a170d3330303430313135353935395a302d310b3009060355040613025048310c300a060355040a13034446413110300e060355040313074453303130373630820122300d06092a864886f70d01010105000382010f003082010a0282010100d1efd35613898709be32888b19bdca6b59f32a44e69571bc2c607aa4d79ad74b1a3733b3ec8d78ffb1cbfe2f9c799b544e9e0a39ccd47bb0e043f09c4ecbad089271af18f28191ed1aca0d5a4c1646314fa711d5b18cf6c04a212f1062fb3dfa381a748bb29790a166da9933495ce41b07ca884641449693a3ba131abfe6f51286bc8e4fa399742c2d047125ec2494c17d575d3bddda472263476119b51fd0e1bc5c46c4928c59d4e6d001522ec525a0191821057ae1baf9ef9426a63577d77917bb97cec3622c78c1faed06f659f3ba3a0ebd88da7698b281d052f845f93098aa644d286f3eb3a1010b6ed6ee4784e7a7260e0ecbcead6534750441cca2b2ed0203010001a38201c7308201c3300e0603551d0f0101ff040403020780301d0603551d0e04160414797455d55b01a403282f3de09cf06a525865ea72305e0603551d23045730558014e565e5d20737598e3d938fc3581660804399b4e7a133a431302f310b3009060355040613025048310c300a060355040a0c034446413112301006035504030c09435343413031303036820822d9252bffe6a957302b0603551d1004243022800f32303139313132353136303030305a810f32303230303430313135353935395a30390603551d1104323030811c70617373706f72742e6469726563746f72406466612e676f762e7068a410300e310c300a06035504070c0350484c30390603551d1204323030811c70617373706f72742e6469726563746f72406466612e676f762e7068a410300e310c300a06035504070c0350484c306d0603551d1f046630643030a02ea02c862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f50484c2e63726c3030a02ea02c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f50484c2e63726c3020060767810801010602041530131301501302504f130250441302505213025053304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a20302012003820201003e7221d14221da072b66a06df3aa5f25ae16d8643cd5b29f4487f45485b1795b15dacf5d4e325239eee33fba07bdff017d0e7f8f14af31a3f4b497d1390daba07d9a5c5463a0e3fc0e44500659f1443ad6db33ae4f93ff9377a7e90cece5ea3846c51804c0bde82d836ef5c0ca29fefb2789b7debf5703b1d35b0112809e5a53b6b09dfba982056b3ecb00e772a942d103eef9bb8e8b3148a76b08505a01e64593845289c89fb6c78f111810c441eb8d4b2b17639b13b7f94b704bdbb38722513cc823633e3228a7c2e5fee76264d1da831354fd2f7171043b6a9398e5fade72a7bb024ea9ad7cbb3232e72400e7af39eb86100a036a3311336c40038e0d0ad0109f10107a827b627cdd367454277078b713aee9ac3b80b65e0bbe995ed0328e266314313aafa3234a845af8c4e39f824718e7cd14b726f29db76b1c57dd5a34526e446f3a54fd570cd228da79ec65eb47597348d8fb06f1109dc88f09192f65f0894879602f52affe0f03550ed04de061a57d81f6fb3d03fb2f323fc36a9f3ce6f9c57e919205526797e1cb7d46ddd9ce7ea56c87e7c4740fa0b88e52b9e47d54a798888e769419a98c9a6afa6f9e5b43314a9fc1f849071338e8d64f6fb7daa45dce179c72db8443730b60d20a9ca210c3e6ffa3bea954114225ac8cb3395e0b3081ac0652d4ac4ee4f86bac8f1c099614159c761643d3c7024f038f874adb"),
		},
		{
			// RU
			sodFileBytes:      utils.HexToBytes("778205783082057406092A864886F70D010702A0820565308205610201033109300706052B0E03021A3081A70606678108010101A0819C048199308196020100300706052B0E03021A30818730190201010414D827533C7441E5D1B203D38CB33C47938657E87530190201020414E434F427BEEB2C72166A981DC4A59D7209A4D8F830190201030414C349DEBEF530D52175CA314DA92A44C6C01FD725301902010D0414ED7A89DCDF13764BDA04E00179D8C02AE3291E76301902010E041432807180F407B08D05AC998EDE91F7F157500741A082034830820344308202EBA003020102020200D0300906072A8648CE3D040130818E310B3009060355040613025255310F300D06035504081306527573736961310F300D060355040713064D6F73636F7731173015060355040A130E46535545205354432041746C6173310D300B060355040B1304555A4953311430120603550403130B435343412D527573736961311F301D06092A864886F70D010901161063616D61696C407374636E65742E7275301E170D3139313131333035353135325A170D3331313131303035353135325A308180310B3009060355040613025255310F300D06035504070C064D6F73636F7731123010060355040A0C095354432D41746C6173310D300B060355040B0C04555A4953311C301A06035504030C13446F63756D656E745F5369676E65725F332E33311F301D06092A864886F70D010901161063616D61696C407374636E65742E72753082014B3082010306072A8648CE3D02013081F7020101302C06072A8648CE3D0101022100FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF305B0420FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC04205AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B031504C49D360886E704936A6678E1139D26B7819F7E900441046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5022100FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC6325510201010342000452E2AA04EED2CFECCF391E81870FEF1DE3C5089A0E6691C45CECE028FDFDFDC6ECBD15C92BE84581ED0D9806429CC43E6758D147F6DAAF3B0A1CFAD2902E0BB7A3523050300E0603551D0F0101FF040403020780301D0603551D0E0416041439D649889FE3DD3C0E81F48961B05B0F6FF6ADA5301F0603551D23041830168014850C53F7160E5DEF64A5677CF7C1849205D2B29C300906072A8648CE3D0401034800304502205F86F3E3545E11AC947423B8B542EB69A1FDA07177DF071A7597B06306AB4FD2022100C847125ABC58CC70D1FEBE52DC9439C2FEB0BF8B98182DAF5FEEA497992CEF84318201593082015502010130819530818E310B3009060355040613025255310F300D06035504081306527573736961310F300D060355040713064D6F73636F7731173015060355040A130E46535545205354432041746C6173310D300B060355040B1304555A4953311430120603550403130B435343412D527573736961311F301D06092A864886F70D010901161063616D61696C407374636E65742E7275020200D0300706052B0E03021AA05A301506092A864886F70D01090331080606678108010101301C06092A864886F70D010905310F170D3230303132323037323135385A302306092A864886F70D01090431160414F4346383DB86975F9C6C59F1C3DB73A8B78A6B3B300906072A8648CE3D040104483046022100C31ABEC9E53734A4728FD6017B719BADD4474A3682B9BCEEF591F040F6F074A30221008AE5C38BA1E519F3B1DBCFA62F724ED4603B7C13AAF76F673C0E0E247F1472F2"),
			expLdsVersion:     "",
			expUnicodeVersion: "",
			expCertCSCA:       utils.HexToBytes("30820410308203b6a003020102020200cb300906072a8648ce3d040130818e310b3009060355040613025255310f300d06035504081306527573736961310f300d060355040713064d6f73636f7731173015060355040a130e46535545205354432041746c6173310d300b060355040b1304555a4953311430120603550403130b435343412d527573736961311f301d06092a864886f70d010901161063616d61696c407374636e65742e7275301e170d3139313031313130313033375a170d3335313030373130313033375a30818e310b3009060355040613025255310f300d06035504081306527573736961310f300d060355040713064d6f73636f7731173015060355040a130e46535545205354432041746c6173310d300b060355040b1304555a4953311430120603550403130b435343412d527573736961311f301d06092a864886f70d010901161063616d61696c407374636e65742e72753082014b3082010306072a8648ce3d02013081f7020101302c06072a8648ce3d0101022100ffffffff00000001000000000000000000000000ffffffffffffffffffffffff305b0420ffffffff00000001000000000000000000000000fffffffffffffffffffffffc04205ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b031504c49d360886e704936a6678e1139d26b7819f7e900441046b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5022100ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255102010103420004534aab29c078ee859689bcb82945c51ed123908f673d6a7b2060bb404dfec70ff9648cb96ca03792962105176797c77d14b4b887f3d6a953f84a4bd91f7de9aea382010d30820109301d0603551d0e04160414850c53f7160e5def64a5677cf7c1849205d2b29c3081c30603551d230481bb3081b88014a01e87502745922760e2d03140375e147c46c002a18194a4819130818e310b3009060355040613025255310f300d06035504081306527573736961310f300d060355040713064d6f73636f7731173015060355040a130e46535545205354432041746c6173310d300b060355040b1304555a4953311430120603550403130b435343412d527573736961311f301d06092a864886f70d010901161063616d61696c407374636e65742e7275820900d1a809e4bb17e99330120603551d130101ff040830060101ff020100300e0603551d0f0101ff040403020106300906072a8648ce3d04010349003046022100f760d46be77e9dfba997c0695be034f65a781b2c14665c95ae960135631342520221009147e130503749ce54e4df0d7f374a51889cea17829eb0251f13cdea338aa0fd"),
			expCertDSC:        utils.HexToBytes("30820344308202eba003020102020200d0300906072a8648ce3d040130818e310b3009060355040613025255310f300d06035504081306527573736961310f300d060355040713064d6f73636f7731173015060355040a130e46535545205354432041746c6173310d300b060355040b1304555a4953311430120603550403130b435343412d527573736961311f301d06092a864886f70d010901161063616d61696c407374636e65742e7275301e170d3139313131333035353135325a170d3331313131303035353135325a308180310b3009060355040613025255310f300d06035504070c064d6f73636f7731123010060355040a0c095354432d41746c6173310d300b060355040b0c04555a4953311c301a06035504030c13446f63756d656e745f5369676e65725f332e33311f301d06092a864886f70d010901161063616d61696c407374636e65742e72753082014b3082010306072a8648ce3d02013081f7020101302c06072a8648ce3d0101022100ffffffff00000001000000000000000000000000ffffffffffffffffffffffff305b0420ffffffff00000001000000000000000000000000fffffffffffffffffffffffc04205ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b031504c49d360886e704936a6678e1139d26b7819f7e900441046b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5022100ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325510201010342000452e2aa04eed2cfeccf391e81870fef1de3c5089a0e6691c45cece028fdfdfdc6ecbd15c92be84581ed0d9806429cc43e6758d147f6daaf3b0a1cfad2902e0bb7a3523050300e0603551d0f0101ff040403020780301d0603551d0e0416041439d649889fe3dd3c0e81f48961b05b0f6ff6ada5301f0603551d23041830168014850c53f7160e5def64a5677cf7c1849205d2b29c300906072a8648ce3d0401034800304502205f86f3e3545e11ac947423b8b542eb69a1fda07177df071a7597b06306ab4fd2022100c847125abc58cc70d1febe52dc9439c2feb0bf8b98182daf5feea497992cef84"),
		},
		{
			// SG
			sodFileBytes:      utils.HexToBytes("778209C5308209C106092A864886F70D010702A08209B2308209AE020103310D300B0609608648016503040201308201210606678108010101A0820115048201113082010D020101300B06096086480165030402013081EA30250201010420B8531D522AF781EBBA2F78465B5BEAB1FCCE2861DD947316A217A0F31F06598330250201020420D2FC98EFFEAAC17D42987C48F310315086FC920054F900002DF114A79FF2774B30250201030420883155F3A1EA7948BF4A416625C767ED1F4ED2EAED731F143CC8A22CEABC0CB13025020104042010500F4BC7437F061D4CE735AC0C4F35CF71ADB7C5112AAF9B2CCB2C9BD20C3A302502010D0420ADED95A855D5C0AC69599F46C4C464AD2AAB053798AEBE74C69472FF2FFBB0B4302502010E04209CDA75E7B4F6168E6586CCD175C0AAB3E90F47A68D68E922122937414A90622D300E1304303130381306303430303030A08206603082065C30820410A00302010202045FCDC27C304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A2030201203060310B30090603550406130253473121301F060355040A0C184D696E6973747279206F6620486F6D652041666661697273310C300A060355040B0C034943413120301E06035504030C1753696E6761706F72652050617373706F72742043412035301E170D3232303632373032333934315A170D3332313132373135313232355A305D310B30090603550406130253473121301F060355040A0C184D696E6973747279206F6620486F6D652041666661697273310C300A060355040B0C03494341311D301B06035504030C1453472044534331302032303232303632372D303130820122300D06092A864886F70D01010105000382010F003082010A0282010100A695EF6E7174AA7428B351D0106D1B31D0CBC40E2D2FEFFA6F6DEF30220648C124856C14006C2B961CFF1D81776E3704A00E0BB243CB72F1776B7F6EB917F5A9450C2D1CBB0574ADD7BB8D75FAE7746D6C622CC0A5314BB5812D680077BD45DDF49F58CF7D5D9294CC8045219C8280F8DDDE95B529C9F4AAAE45150252B5C691C46B78FF58DF1F2D7ACE90E14E0920B6E4524E87E596E232F6B80D0BCBBECA94EDB552E4EAAACA21AE6AE56C0F961836C90E198AED563100B49E1BB93497592B2CE6A61A494CF76219B96FA52675A4FA39C6249FC07665564BEC456CDB9217A6FBFA9AF2E043968B51E551CF70861E5BFA5493F3FFE40FF937CF5B55E50135E70203010001A38201B7308201B3300E0603551D0F0101FF0404030207803015060767810801010602040A30080201003103130150301B0603551D1204143012A410300E310C300A06035504070C03534750301B0603551D1104143012A410300E310C300A06035504070C035347503081E20603551D1F0481DA3081D7305CA05AA058862A68747470733A2F2F706B64646F776E6C6F6164312E6963616F2E696E742F43524C732F5347502E63726C862A68747470733A2F2F706B64646F776E6C6F6164322E6963616F2E696E742F43524C732F5347502E63726C3077A075A073A471306F310B30090603550406130253473121301F060355040A0C184D696E6973747279206F6620486F6D652041666661697273310C300A060355040B0C034943413120301E06035504030C1753696E6761706F72652050617373706F72742043412035310D300B06035504030C0443524C31302B0603551D1004243022800F32303232303632373032333934315A810F32303232313132373135313232355A301F0603551D2304183016801484CD5D8A477755058D4EC97E0D4992322BE1C545301D0603551D0E04160414A91A62A686DF680A934C0B68032BFAAA100638A6304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A203020120038202010027186E71CB7F33B78FD28565EB886A8224BAB30752BDE7C53257360C872DE2E89318C14F0BBCBE8B34D08463F504C5AD11E5603B71F3D075B00FBED8FB16E9C5F9E95221783F9463C67F78CC3BD80D6EB8B523DE1C7EAD4C88F4CE3B799A2F60BDC11919FF9A68698686072740F7AB6B60F4958E29C6D7113BA25FEC02A1852783068847476DC313889D5DF2255097067EDC02E97EECBC2B42C8B3072171540320745994C42BF7F3E67E47DC20859C2BA02E722B22568E26BC8429480EC1C95B1F02A14BEA48CC51961AC8DDD35702CA814530D4C8125762655125D67EA6B38570D779EBFD6C3C53636CB65B92F4AE27632C7EB15588A537E1619BD3125F7F80CB80E53DE0C998AFDCF02D07D1FC6DE140C462A9C868742BD8FB256CF2F231A3DB45D54C407D262B4365A5A84CA4243327A31A792F56AE9376C56FC84E63FFC079E85EEC6B866465EED66D95520448D74B09F20E450F4B6B116E85A2BC9C0DEAF6DC0063841E49E8C17478E67F28DB7451D97AF0B82996094808B14A2AD0523D75ECDEC9B1E44FDD44D821591439B13ED851AE532FE70447E6504F455FB9D5F7E4FDA0736D6C3F5895C6A474CDEF2A2213A698E101FFA89D6325C37E0FBABAE6DBA6064FA33479C7C2055C2B245A609A57DE4B254A4ECA9DA97ECB288510F94BE8DCC76520874E76930FFD61AFAD808374C916E3A08B1F2EF6BE8070816109743182020F3082020B02010130683060310B30090603550406130253473121301F060355040A0C184D696E6973747279206F6620486F6D652041666661697273310C300A060355040B0C034943413120301E06035504030C1753696E6761706F72652050617373706F7274204341203502045FCDC27C300B0609608648016503040201A048301506092A864886F70D01090331080606678108010101302F06092A864886F70D01090431220420F990482CF40E723640E3B80910805150E5F5E461FC94C147FB47524D0055445D304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A2030201200482010038D6B5B0DBDCB5CBE3C196613EF5A7311BF391AEA6DED3AACC763AF849AE8D166FA627658F051B18FC119E430B9E1578BF6A9ED5CD6978701FB81D26735D623D835233EA8613E0A96226E048A02BCD776742BB5CB4D97008608B140DF58F15E0900FBE433C0A370F99D77D057F19FEF490297FBD525AF0D8D0F4AC64DB54489009D68FABD416237B2C90C7E98402FF04DAA6CAD7D08933A78D26D2FE111643F1B530DE43DF71AE701EF960B273DF6B0B9A664AA01ED4D601A2C2192185E1E8729C386A89DDB47101DDE606DEEFD8F6815D598601FB6943DA2BB5B044FA034C770DF2529D6379A6D5189328E3C04936833E7BBE9E65DEA4CE103D8494EFADB04F"),
			expLdsVersion:     "0108",
			expUnicodeVersion: "040000",
			expCertCSCA:       utils.HexToBytes("3082073e308204f2a003020102020458ed1ee3304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412034301e170d3230313231343033323234365a170d3332303431303136303030305a3060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f7274204341203530820222300d06092a864886f70d01010105000382020f003082020a0282020100b687b2fa93ffce2c110051857a65fd68ce3960a260c462af3e9bfa6f269f5ab8965d38cb22ba7f35471ca4b33e7904e183c594d4b9e84c74c04821cf528c3fa83bb6a3f4c0c317e4c95a5acc5339b4c4dd9db8eceb64db29fb88f96525ebde38e48ebe40ffa95b842f16a721e5bae8327d9545e9dc0bd143df441f6f4ed672b1711c6b20e0d266a9866c50eb172ac5dd4530969038d955a7b87bc7656395ddd670c1392672eba4f05e9dc36b563ab3fba1bad9de0ff2df8b1deb562c0ccfe88579d7318e2a6342e6dba73b716c32c830a1f7476b36f80b2dad1f0ce27c9a00610cf4d7f213f35796fc6b26c336fef1db2143dc196c02fde859239dee0bdd459aacd0481ffef9eb1a6d9f52699d570289e3fd2da753195836b2fe51a827ff8ea497059faa496b36831e5554f8f306e835b086e0b7ad30afc1e55d6a15fc1036cf6b54042320747ab7d6d5fc86113937297227758c7cebf21f3827acce909026ceb4ab4d16e065e3bd82dab7ee40abaab58085c96c5f1d19bc16a94b23bf8c0572b7d88b8a4a21a0ae77a231b0bbdaf40d5205e33161a4d8b8722c308d6a565f34f38b50ff84bda8f9ee9f0e584ceac279aa337fbddb9c9b1069a7304955422da53ae35dd72ea2d7827864a698c0980a322b59ba6a4a00dbd115a2f663fafd89413b02f416130875c6bc8e3da4b8bb49c1b6ecfefc1fa2d965fc9e38abd47542030203010001a382019630820192300e0603551d0f0101ff04040302010630120603551d130101ff040830060101ff020100301b0603551d1104143012a410300e310c300a06035504070c03534750301b0603551d1204143012a410300e310c300a06035504070c03534750300d06076781080101060104020500301d0603551d0e0416041484cd5d8a477755058d4ec97e0d4992322be1c5453081e20603551d1f0481da3081d7305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5347502e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5347502e63726c3077a075a073a471306f310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412034310d300b06035504030c0443524c31301f0603551d230418301680143a4d8de8fe2407a702bb9f7a320313098a2d4a8d304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a20302012003820201002c1e6f18243012bbfacbb221288f6ae183a002ab685cde0a88cedf8df3fe2db49ca5c095ff77db18be73a73caeea1354c904537b2a03ee3392f70c495e132425072c6d6486dde9ff8d7cb212f4223450c5d95ba65af751960a95f5b83d33afe29edd1bd03013bac1cda14153e7711a2c5f15d5bb705fbf7bf9e82c86194316acb206ea0296fec914adf4a974ceb836942f86f023e5f42dde194712742cf00f510671e4ea67c542e7b9411512f88b24b5f50a2e5f76fefb7f359bc25d2973105622fd15f1db595139d0ea180e2eb49339b42728d86b94b8a32e9efe0c38651f9a135eaf2797a7344038d4f9b7496386a76f4be504a8eafb773a1523a26b2c61fdf57cf09bd97a22845f64477d78e37636b5c370dff16bb13d43eeeea44d6ba0f73d869139b71c921ed04027349a02743883d107d8d06b354dd192a12bedebca30d3b050c1accf0b6323049b6147ceea9dc1a05dbc6aeb7489dbecb1ed889425e48c455b12c45dc277ef59c32944f1feefaf166d80b2886bd477177dc7a11c1bfe87b92c316808cedff831b4851adbded2cb0c8cb46361e6b187082ab57499a38f3e707e3160268e13f89bd40942fccfaba0677313ad6ec4012e6d3206f4ead57731dd1fca98c72143555f0416e4d080d8de8985af6542659ce82facdac3795c8edcb5849e3740e23cc788eac0a8cedb91aa7d9697d07f4ed3a0b98dc6b2135b89"),
			expCertDSC:        utils.HexToBytes("3082065c30820410a00302010202045fcdc27c304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412035301e170d3232303632373032333934315a170d3332313132373135313232355a305d310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c03494341311d301b06035504030c1453472044534331302032303232303632372d303130820122300d06092a864886f70d01010105000382010f003082010a0282010100a695ef6e7174aa7428b351d0106d1b31d0cbc40e2d2feffa6f6def30220648c124856c14006c2b961cff1d81776e3704a00e0bb243cb72f1776b7f6eb917f5a9450c2d1cbb0574add7bb8d75fae7746d6c622cc0a5314bb5812d680077bd45ddf49f58cf7d5d9294cc8045219c8280f8ddde95b529c9f4aaae45150252b5c691c46b78ff58df1f2d7ace90e14e0920b6e4524e87e596e232f6b80d0bcbbeca94edb552e4eaaaca21ae6ae56c0f961836c90e198aed563100b49e1bb93497592b2ce6a61a494cf76219b96fa52675a4fa39c6249fc07665564bec456cdb9217a6fbfa9af2e043968b51e551cf70861e5bfa5493f3ffe40ff937cf5b55e50135e70203010001a38201b7308201b3300e0603551d0f0101ff0404030207803015060767810801010602040a30080201003103130150301b0603551d1204143012a410300e310c300a06035504070c03534750301b0603551d1104143012a410300e310c300a06035504070c035347503081e20603551d1f0481da3081d7305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5347502e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5347502e63726c3077a075a073a471306f310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412035310d300b06035504030c0443524c31302b0603551d1004243022800f32303232303632373032333934315a810f32303232313132373135313232355a301f0603551d2304183016801484cd5d8a477755058d4ec97e0d4992322be1c545301d0603551d0e04160414a91a62a686df680a934c0b68032bfaaa100638a6304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a203020120038202010027186e71cb7f33b78fd28565eb886a8224bab30752bde7c53257360c872de2e89318c14f0bbcbe8b34d08463f504c5ad11e5603b71f3d075b00fbed8fb16e9c5f9e95221783f9463c67f78cc3bd80d6eb8b523de1c7ead4c88f4ce3b799a2f60bdc11919ff9a68698686072740f7ab6b60f4958e29c6d7113ba25fec02a1852783068847476dc313889d5df2255097067edc02e97eecbc2b42c8b3072171540320745994c42bf7f3e67e47dc20859c2ba02e722b22568e26bc8429480ec1c95b1f02a14bea48cc51961ac8ddd35702ca814530d4c8125762655125d67ea6b38570d779ebfd6c3c53636cb65b92f4ae27632c7eb15588a537e1619bd3125f7f80cb80e53de0c998afdcf02d07d1fc6de140c462a9c868742bd8fb256cf2f231a3db45d54c407d262b4365a5a84ca4243327a31a792f56ae9376c56fc84e63ffc079e85eec6b866465eed66d95520448d74b09f20e450f4b6b116e85a2bc9c0deaf6dc0063841e49e8c17478e67f28db7451d97af0b82996094808b14a2ad0523d75ecdec9b1e44fdd44d821591439b13ed851ae532fe70447e6504f455fb9d5f7e4fda0736d6c3f5895c6a474cdef2a2213a698e101ffa89d6325c37e0fbabae6dba6064fa33479c7c2055c2b245a609a57de4b254a4eca9da97ecb288510f94be8dcc76520874e76930ffd61afad808374c916e3a08b1f2ef6be807081610974"),
		},
		{
			// UK
			sodFileBytes:      utils.HexToBytes("778205F4308205F006092A864886F70D010702A08205E1308205DD020103310D300B06096086480165030402013081A80606678108010101A0819D04819A308197020101300B06096086480165030402013075302502010104204BC4557CEB919591EC29A09A7DAD569D6F8FD01CA09D1DD9268ADEC7E81AE33C3025020102042082138F13331D5D689950B7FD60B725639F203D8415877DEB89D3C68DC37E3F62302502010E042002BE33BA93183907394F3392C80C9A4B07988D79B6CA603E2A3DFB2BA2972411300E1304303130381306303430303030A082041C308204183082039DA0030201020204492EFAE1300A06082A8648CE3D0403023041310B3009060355040613024742310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F72697479301E170D3231303230313030303030305A170D3332303630313030303030305A305D310B3009060355040613024742311B3019060355040A1312484D2050617373706F7274204F6666696365310F300D060355040B13064C6F6E646F6E3120301E06035504031317446F63756D656E74205369676E696E67204B6579203332308201333081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF30440420FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC04205AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B0441046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5022100FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC63255102010103420004131A1D896C1DC77DB755369EF5E04E18E096C93AF47F0376D4FDA7A3279467A7AEFF72AF3D6D3ED2CD7E0C8DF96A1755B4C7E273CE7BE98C96BBDB5647723C14A38201893082018530400603551D11043930378123646F63756D656E742E746563686E6F6C6F677940686D706F2E6773692E676F762E756BA410300E310C300A06035504071303474252302B0603551D1004243022800F32303231303230313030303030305A810F32303231303530343030303030305A300E0603551D0F0101FF04040302078030400603551D1204393037A410300E310C300A060355040713034742528123646F63756D656E742E746563686E6F6C6F677940686D706F2E6773692E676F762E756B3019060767810801010602040E300C02010031071301501302505430670603551D1F0460305E305CA05AA058862A68747470733A2F2F706B64646F776E6C6F6164312E6963616F2E696E742F43524C732F4742522E63726C862A68747470733A2F2F706B64646F776E6C6F6164322E6963616F2E696E742F43524C732F4742522E63726C301F0603551D23041830168014DB1D1657C76023089B0139E2613C082134B57CA1301D0603551D0E04160414241401EEFFB0D8FE4D7795F04095099FF989324B300A06082A8648CE3D0403020369003066023100807A00C2CECB43217DBC7085CE19E1825A8E779D6817205B4E1CDB9A29126D0DB39048DB22B4A29AFF40121864BC247C023100A84FE4A9E39C283E0737D4A0278D0802EA0F64993157C7B9885BA0EDEB2943575C53965E340EE6ECC9277F903491AE3F3181FD3081FA02010130493041310B3009060355040613024742310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F726974790204492EFAE1300B0609608648016503040201A048301506092A864886F70D01090331080606678108010101302F06092A864886F70D0109043122042054EE2228A8CEB8FB50C9C115E0B31592B0FC04C637AC5570E7A3E1CA6AD07864300A06082A8648CE3D0403020447304502200DF1170FDD25EF705902A192FAAB5EEDDD1EA0456DF09BCC1E3984A5BEE1B48E0221009033C37718684ED511C240EFA52278D795BC9410A5C2AE9E92B8773346D3D3B6"),
			expLdsVersion:     "0108",
			expUnicodeVersion: "040000",
			expCertCSCA:       utils.HexToBytes("3082048e30820413a0030201020204492eeb29300a06082a8648ce3d0403033041310b3009060355040613024742310e300c060355040a1305554b4b50413122302006035504031319436f756e747279205369676e696e6720417574686f72697479301e170d3136303930393130323633315a170d3333303130393130353633315a3041310b3009060355040613024742310e300c060355040a1305554b4b50413122302006035504031319436f756e747279205369676e696e6720417574686f72697479308201cc3082016406072a8648ce3d020130820157020101303c06072a8648ce3d0101023100fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff307b0430fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc0430b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef031500a335926aa319a27a1d00896a6773a4827acdac73046104aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab73617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f023100ffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc529730201010362000460a2ff75eaad3c327bb559ae164c018c58b14f1328c4c908239e4a9172245294776b7efdd9a703e03bc857d1ff18de1411a35b502d90728fd46d1a56db769458131a52f52564f602cec8ee5f51bc6cb05f309203e4d73d421f0ff09fbc2e2c21a38201823082017e300e0603551d0f0101ff04040302010630120603551d130101ff040830060101ff02010030400603551d11043930378123646f63756d656e742e746563686e6f6c6f677940686d706f2e6773692e676f762e756ba410300e310c300a0603550407130347425230400603551d12043930378123646f63756d656e742e746563686e6f6c6f677940686d706f2e6773692e676f762e756ba410300e310c300a0603550407130347425230670603551d1f0460305e305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f4742522e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f4742522e63726c302b0603551d1004243022800f32303136303930393130323633315a810f32303231313030323231353835355a301f0603551d23041830168014db1d1657c76023089b0139e2613c082134b57ca1301d0603551d0e04160414db1d1657c76023089b0139e2613c082134b57ca1300a06082a8648ce3d0403030369003066023100aa7fa30648d1460dd1e3036c07d1bd446a1037245c511245cf98e2cb5117ec31c4ee2424bcef4529b1c5565c3a4458a9023100b74bcdd99aaf45da3f9cfb37c984e447c6f01f97216a20103943ae9735b50680392d28aa3df315ebe10f7c132d89a85c"),
			expCertDSC:        utils.HexToBytes("308204183082039da0030201020204492efae1300a06082a8648ce3d0403023041310b3009060355040613024742310e300c060355040a1305554b4b50413122302006035504031319436f756e747279205369676e696e6720417574686f72697479301e170d3231303230313030303030305a170d3332303630313030303030305a305d310b3009060355040613024742311b3019060355040a1312484d2050617373706f7274204f6666696365310f300d060355040b13064c6f6e646f6e3120301e06035504031317446f63756d656e74205369676e696e67204b6579203332308201333081ec06072a8648ce3d02013081e0020101302c06072a8648ce3d0101022100ffffffff00000001000000000000000000000000ffffffffffffffffffffffff30440420ffffffff00000001000000000000000000000000fffffffffffffffffffffffc04205ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b0441046b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5022100ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255102010103420004131a1d896c1dc77db755369ef5e04e18e096c93af47f0376d4fda7a3279467a7aeff72af3d6d3ed2cd7e0c8df96a1755b4c7e273ce7be98c96bbdb5647723c14a38201893082018530400603551d11043930378123646f63756d656e742e746563686e6f6c6f677940686d706f2e6773692e676f762e756ba410300e310c300a06035504071303474252302b0603551d1004243022800f32303231303230313030303030305a810f32303231303530343030303030305a300e0603551d0f0101ff04040302078030400603551d1204393037a410300e310c300a060355040713034742528123646f63756d656e742e746563686e6f6c6f677940686d706f2e6773692e676f762e756b3019060767810801010602040e300c02010031071301501302505430670603551d1f0460305e305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f4742522e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f4742522e63726c301f0603551d23041830168014db1d1657c76023089b0139e2613c082134b57ca1301d0603551d0e04160414241401eeffb0d8fe4d7795f04095099ff989324b300a06082a8648ce3d0403020369003066023100807a00c2cecb43217dbc7085ce19e1825a8e779d6817205b4e1cdb9a29126d0db39048db22b4a29aff40121864bc247c023100a84fe4a9e39c283e0737d4a0278d0802ea0f64993157c7b9885ba0edeb2943575c53965e340ee6ecc9277f903491ae3f"),
		},
		{
			// US
			sodFileBytes:      utils.HexToBytes("77820A7730820A7306092A864886F70D010702A0820A6430820A60020103310F300D060960864801650304020105003081C20606678108010101A081B70481B43081B1020100300D0609608648016503040201050030819C302502010104203959D386A57E8CE7E582AEC8C5651C2003AE7634204503F830573350515256FC302502010204203B03FE8D111C545CF4E556AF7364F36731693D5841F539660647190D0420828D302502010B042032DFA16776C6C3CBCCD7BBB05C8B4345CC538C62CE630CD11EBCDE62A26F029D302502010C0420D9B8686DEFD4BBAF96520E077C2B35BB98B5ADD0DC1EA17379FD44B6BEB961FDA082073F3082073B30820523A00302010202045DCDFDE3300D06092A864886F70D01010B05003081A3310B300906035504061302555331183016060355040A0C0F552E532E20476F7665726E6D656E74311C301A060355040B0C134465706172746D656E74206F66205374617465310D300B060355040B0C044D52544431223020060355040B0C1943657274696669636174696F6E20417574686F72697469657331293027060355040B0C20552E532E204465706172746D656E74206F66205374617465204D525444204341301E170D3231303631303230343033365A170D3336313030323038343634355A308189310B300906035504061302555331183016060355040A0C0F552E532E20476F7665726E6D656E74311C301A060355040B0C134465706172746D656E74206F66205374617465310D300B060355040B0C044D52544431193017060355040B0C10446F63756D656E74205369676E6572733118301606035504030C0F44532032303231303631303136343130820122300D06092A864886F70D01010105000382010F003082010A0282010100A5A5964E7B8E9D8C623BDA63760D1406374026D81F21E34F6B06C6F47774D9DF7A0E9D7979BA2C72D4EACC45D1A58A4C5FC20BAD8AE23FDC4024C8E53A8ACDC2B083EC55B63D44D557E048ED1B843CD2B99C147B350C6FB9B67FD02076BEC134C785F4DE58A1AA137196D6FB7EEFD47A03F25996841345A4DAAB7754B047DAB57E5786D54DE5CDE5FAF553F44DE67069F84C2C38E57D0FD13255C814629BAFB2C8932EC8E7029D9EC59D640982F89545E30F22036E0BC58E3E8D4AC8E43C3429BDD9BD545CE6AD1045B28D839169060D93AF72F59BBFA0687C8A90D12BAD51481CC991DF9855DD7AA8FA31250B39AB52563B211362F539A47C167CA496FCBD510203010001A382028D30820289300E0603551D0F0101FF040403020780301C0603551D120415301381116D7274646F70734073746174652E676F763015060767810801010602040A300802010031031301503081990603551D1F04819130818E30818BA08188A08185862A68747470733A2F2F706B64646F776E6C6F6164312E6963616F2E696E742F43524C732F5553412E63726C862A68747470733A2F2F706B64646F776E6C6F6164322E6963616F2E696E742F43524C732F5553412E63726C862B687474703A2F2F63726C732E706B692E73746174652E676F762F63726C732F55534D52544443412E63726C308201190603551D20048201103082010C30820108060A608648016503020106643081F93081F606082B060105050702023081E9301F1618552E532E204465706172746D656E74206F6620537461746530030201011A81C5546869732070617373706F727420616E6420746865206469676974616C206365727469666963617465206F6E2069747320656D626564646564206368697020617265207468652070726F7065727479206F662074686520555320676F7665726E6D656E742E2020416E7920756E617574686F72697A656420757365206F7220617474656D70746564206368616E6765206F72207472616E736665722069732070726F6869626974656420616E64206D61792062652070756E6973686564206279206C61772E301C0603551D110415301381116D7274646F70734073746174652E676F76302B0603551D1004243022800F32303231303631303230343033365A810F32303231313030353038343634355A301F0603551D23041830168014F18A8BFB6A44A3468334D2D592158158824A4CFB301D0603551D0E04160414BBE9FE4B7CF03921F493096F7CC3E8ACBDE3A227300D06092A864886F70D01010B050003820201005473C8793FE0DBA3BD69864F662CC7277F5FF3181C940714309CDEF54896545417B0196599CA534003992AB71F957322257583C13DEF89954C83D963308B5BFAE3598426A70AFE74960F18B2085BBAE961C209BAC961AD3F5542D569191EBE6E352E5483E51C566F949489DB849831668E8DB2ABDFCC2590BCF2B50EFE76B9B125B3BF8591CFD6A35D9382A09C67072F5DC40F973A6DDC03F56A423077C086B95BDF629E444188544569C061B5C44183D825297342B9995FDA4DE15828884F6B767460C785DA6C3042B38399210623C75E06BBA8C63BF33C9A11ED3805BCC7148BC8313246FC40F55AF8CA0AC9307863869AD70A70FD368A7C47B2330E4BFC6D0225279C18240410CEC5A4D873DD8E14D4BA80FF58EF93804277DEA78B8D331525D26CCCF0FFEDB6221B9E7AA54438D15A39058BD36857EEA6060AA9D3A614F4CE8C217A00AF83EE78BE646948141D3BD59E5766E337940105DA2793B36ACE828902A970F78540D8849A48CB43909702AFD2EDAAE82F98D9A9166233944F76D7A92619F48CE4BC085D98209BFFBE729D32681E6E6CEF92D3B41D9417146F4ABEF77EBA98920CAB753C6B88D4D31B1A4D8FC077C2B2615E25FAB9F225B0D62024EC6605C69C1FF55009FF131D0F177AA77C6571FE4491BF13ED8C6FF094B157562253D74C7372F63A17E2CC3A8334134608AE9C66CB5E3B85EF4D5494E7276EED318202403082023C0201013081AC3081A3310B300906035504061302555331183016060355040A0C0F552E532E20476F7665726E6D656E74311C301A060355040B0C134465706172746D656E74206F66205374617465310D300B060355040B0C044D52544431223020060355040B0C1943657274696669636174696F6E20417574686F72697469657331293027060355040B0C20552E532E204465706172746D656E74206F66205374617465204D52544420434102045DCDFDE3300D06096086480165030402010500A066301506092A864886F70D01090331080606678108010101301C06092A864886F70D010905310F170D3231303931363133343530305A302F06092A864886F70D0109043122042026861D5F7C7699780ACAAAA0258E5255217B41A8D9AD797C9716EA755CF0F6CF300D06092A864886F70D0101010500048201003862F39E9140BDE1296F4D4A2B007C03F79D8104D931F85E0F1B7ED54ED2C12C2C548BD167B3CA03BF72E82E28B380B0199D30F2BEF17543892E2A2C9FA17CFCBD1A2DB9900C3052D8C3AB138D870014ECB7EFA4A03775F873EFB96E995871589981B0A6BF06A2897BC41DA92A4D88E3E071CD234AAD569E0EBFDCEE59F065724F3B7087EC328A6DC17538794B79343A194FB91966F4F615F66C2E5B5605803883A87637323E5E9D10D0497E9184C80A6D7CFAD0D77FEA773B487B7A44115650B73241F5AF1AE7EB7D90882C65FEBDD9CE183C93B6589F521A948C5E3994BFE09266C95E0BD9DDE4B297B2613B6FF75D52087C112AA8291C3D2AD7F3E5A39233"),
			expLdsVersion:     "",
			expUnicodeVersion: "",
			expCertCSCA:       utils.HexToBytes("30820714308204fca00302010202044e32d006300d06092a864886f70d01010b05003081a3310b300906035504061302555331183016060355040a0c0f552e532e20476f7665726e6d656e74311c301a060355040b0c134465706172746d656e74206f66205374617465310d300b060355040b0c044d52544431223020060355040b0c1943657274696669636174696f6e20417574686f72697469657331293027060355040b0c20552e532e204465706172746d656e74206f66205374617465204d525444204341301e170d3139313131343136333731325a170d3430303531343137303731325a3081a3310b300906035504061302555331183016060355040a0c0f552e532e20476f7665726e6d656e74311c301a060355040b0c134465706172746d656e74206f66205374617465310d300b060355040b0c044d52544431223020060355040b0c1943657274696669636174696f6e20417574686f72697469657331293027060355040b0c20552e532e204465706172746d656e74206f66205374617465204d52544420434130820222300d06092a864886f70d01010105000382020f003082020a0282020100a3320e36162a5de2d64e2dab8439be5f6657d4e314aff8fb0d981ceb35d9ed5cec61507ee8046221ba24efb4b13ed93d65e508aae8e35b9f49c9bf8452223a8222193aef7363b040f8d41f8597b2c33af55ca5e17d139de669948afdcdcf9ba430117006809a38751c868ab09a5df994293e5fb2b734e4bef8759b9f1bd1405a8e22db1371a320da3a7d045faf987af49dbb9cb22e3303707350a5acadbbdc574e4ce07ff2a32aeeff9baaf0992d4b16f10b32b788a5d5ca2e92c1190e8897a46f3b552a8b842d095586584669c50e43cb9bf8f4dae204562951ed87af189985b9935dbfd81e760abcc09ddc4219ec1f3792af0f2e70a101035c7709f8ef6ce77962623645354e5c78bf91e3c8d4a172d53ee0a65c540aaa8d4dfedfbe95647a89c5b2f2d9651d91acaf5183557d3e118fb48095142d1f923f3b00aade48802ab406543f8b3e222d44bc7c0a07b38e80537bbfc873516a906edd73aa2b00a6407d87354b9f519c83e7a71568807313420b58ac18ec768470fdbccb40fffbe3a9a8fcf8e1cf188702dc49da0860920e6f7173055b2afb5076dd57aa4d9f08c690e4238c2e9812f0252f9e275dfa5c151e80bd61410bf9051adc37f5e027dc320b8dd037e77c2df056519428772ee42970b42adadab601f0c1acc277197c3d1de9d1a7976ef79405b266c91412dbb8c3ca49dcad852bce41bc5915a1ad6d2d511d0203010001a382014c30820148301c0603551d120415301381116d7274646f70734073746174652e676f76301c0603551d110415301381116d7274646f70734073746174652e676f76300e0603551d0f0101ff04040302010630120603551d130101ff040830060101ff0201003081990603551d1f04819130818e30818ba08188a08185862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5553412e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5553412e63726c862b687474703a2f2f63726c732e706b692e73746174652e676f762f63726c732f55534d52544443412e63726c302b0603551d1004243022800f32303139313131343136333731325a810f32303235303531353130303930395a301d0603551d0e04160414f18a8bfb6a44a3468334d2d592158158824a4cfb300d06092a864886f70d01010b0500038202010011a182c2475762fa2506aab7018bf001485c78a079b6709ccc013edcb3a71401bcde1a11442d81022738dbc1bf77950820f08a4597c99c04f4f8ca832564364a2b30e2ced23d853c0b270d39e27e68464e98266ff8e60dd0d4751bfb4c2fe87cd77d1942c757e33ec3d014ea5c2882a074d73541aac46b19d44871b6f627bd136591ddd0fcc8215691b746be695fe053be3f53be81f53049b7cbbae520e510e27fd6d4f83ed5073b82fba431b9e291a3acbdf5965c9874c9e9db1ac3fa0a001381f857d269dd9118bbe92329e92a3a4f369a05c3c1fc15c4a93a2c2976d4a9e6d7602c0295c11ffa85530686ec2c4b19b19276cba2968a4810b5b21a78b9934e95236387f776b2c61f18f2eb5ae4c045bfdd0fd1fd4908e07aa59957c089f1c3404ac81e9c8c1bca0987ef4276a77faa96603858babceaaa4eceb0943996941d8b954a34c46fc7f20865230296ab9f25673c4530a9e556382f6d6d9b6c715f5613803d734bbc82bd433d555621d5eb85da5778e650c090e6b0a2f24e8ff2a7b1982cc06f35970ccfea2b72cc935e8ce71a4fd7bbfee9893a4a419f843d3f32069df36f6ccdb340a988d4c3faccdd9bf5191385a5d247f308f033d1f48aa6b65aee27e889a659ccec339299e4a54d92b9870a42ac93c3413e529ed9daa863d8d8e4c5a8a41634e39b8774dddc2753ea2300bc2e7c91b52c88fd5528405501b465"),
			expCertDSC:        utils.HexToBytes("3082073b30820523a00302010202045dcdfde3300d06092a864886f70d01010b05003081a3310b300906035504061302555331183016060355040a0c0f552e532e20476f7665726e6d656e74311c301a060355040b0c134465706172746d656e74206f66205374617465310d300b060355040b0c044d52544431223020060355040b0c1943657274696669636174696f6e20417574686f72697469657331293027060355040b0c20552e532e204465706172746d656e74206f66205374617465204d525444204341301e170d3231303631303230343033365a170d3336313030323038343634355a308189310b300906035504061302555331183016060355040a0c0f552e532e20476f7665726e6d656e74311c301a060355040b0c134465706172746d656e74206f66205374617465310d300b060355040b0c044d52544431193017060355040b0c10446f63756d656e74205369676e6572733118301606035504030c0f44532032303231303631303136343130820122300d06092a864886f70d01010105000382010f003082010a0282010100a5a5964e7b8e9d8c623bda63760d1406374026d81f21e34f6b06c6f47774d9df7a0e9d7979ba2c72d4eacc45d1a58a4c5fc20bad8ae23fdc4024c8e53a8acdc2b083ec55b63d44d557e048ed1b843cd2b99c147b350c6fb9b67fd02076bec134c785f4de58a1aa137196d6fb7eefd47a03f25996841345a4daab7754b047dab57e5786d54de5cde5faf553f44de67069f84c2c38e57d0fd13255c814629bafb2c8932ec8e7029d9ec59d640982f89545e30f22036e0bc58e3e8d4ac8e43c3429bdd9bd545ce6ad1045b28d839169060d93af72f59bbfa0687c8a90d12bad51481cc991df9855dd7aa8fa31250b39ab52563b211362f539a47c167ca496fcbd510203010001a382028d30820289300e0603551d0f0101ff040403020780301c0603551d120415301381116d7274646f70734073746174652e676f763015060767810801010602040a300802010031031301503081990603551d1f04819130818e30818ba08188a08185862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5553412e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5553412e63726c862b687474703a2f2f63726c732e706b692e73746174652e676f762f63726c732f55534d52544443412e63726c308201190603551d20048201103082010c30820108060a608648016503020106643081f93081f606082b060105050702023081e9301f1618552e532e204465706172746d656e74206f6620537461746530030201011a81c5546869732070617373706f727420616e6420746865206469676974616c206365727469666963617465206f6e2069747320656d626564646564206368697020617265207468652070726f7065727479206f662074686520555320676f7665726e6d656e742e2020416e7920756e617574686f72697a656420757365206f7220617474656d70746564206368616e6765206f72207472616e736665722069732070726f6869626974656420616e64206d61792062652070756e6973686564206279206c61772e301c0603551d110415301381116d7274646f70734073746174652e676f76302b0603551d1004243022800f32303231303631303230343033365a810f32303231313030353038343634355a301f0603551d23041830168014f18a8bfb6a44a3468334d2d592158158824a4cfb301d0603551d0e04160414bbe9fe4b7cf03921f493096f7cc3e8acbde3a227300d06092a864886f70d01010b050003820201005473c8793fe0dba3bd69864f662cc7277f5ff3181c940714309cdef54896545417b0196599ca534003992ab71f957322257583c13def89954c83d963308b5bfae3598426a70afe74960f18b2085bbae961c209bac961ad3f5542d569191ebe6e352e5483e51c566f949489db849831668e8db2abdfcc2590bcf2b50efe76b9b125b3bf8591cfd6a35d9382a09c67072f5dc40f973a6ddc03f56a423077c086b95bdf629e444188544569c061b5c44183d825297342b9995fda4de15828884f6b767460c785da6c3042b38399210623c75e06bba8c63bf33c9a11ed3805bcc7148bc8313246fc40f55af8ca0ac9307863869ad70a70fd368a7c47b2330e4bfc6d0225279c18240410cec5a4d873dd8e14d4ba80ff58ef93804277dea78b8d331525d26cccf0ffedb6221b9e7aa54438d15a39058bd36857eea6060aa9d3a614f4ce8c217a00af83ee78be646948141d3bd59e5766e337940105da2793b36ace828902a970f78540d8849a48cb43909702afd2edaae82f98d9a9166233944f76d7a92619f48ce4bc085d98209bffbe729d32681e6e6cef92d3b41d9417146f4abef77eba98920cab753c6b88d4d31b1a4d8fc077c2b2615e25fab9f225b0d62024ec6605c69c1ff55009ff131d0f177aa77c6571fe4491bf13ed8c6ff094b157562253d74c7372f63a17e2cc3a8334134608ae9c66cb5e3b85ef4d5494e7276eed"),
		},
	}
	for _, tc := range testCases {
		sod, err := NewSOD(tc.sodFileBytes)

		if err != nil {
			t.Errorf("Unexpected error: %s", err)
		}

		if sod == nil {
			t.Errorf("SOD expected")
			break
		}

		if sod.ldsVersion() != tc.expLdsVersion {
			t.Errorf("LDS Version differs to expected (exp:%s, act:%s)", tc.expLdsVersion, sod.ldsVersion())
		}

		if sod.unicodeVersion() != tc.expUnicodeVersion {
			t.Errorf("Unicode Version differs to expected (exp:%s, act:%s)", tc.expUnicodeVersion, sod.unicodeVersion())
		}

		{
			// get the CSCA certificate pool
			var cscaCertPool *cms.CertPool = cms.CscaCertPool()

			var certChain [][]byte

			certChain, err = sod.SD.SD2.Verify(cscaCertPool)
			if err != nil {
				t.Errorf("Error verifying SignedData: %s", err)
			}

			if len(certChain) != 2 {
				t.Errorf("Cert chain should have 2 certs")
			}

			// verify CSCA cert
			if !bytes.Equal(certChain[0], tc.expCertCSCA) {
				t.Errorf("Cert (CSCA) mismatch (exp:%x, act:%x)", tc.expCertCSCA, certChain[0])
			}

			// verify DSC cert
			if !bytes.Equal(certChain[1], tc.expCertDSC) {
				t.Errorf("Cert (DSC) mismatch (exp:%x, act:%x)", tc.expCertDSC, certChain[1])
			}
		}
	}
}
