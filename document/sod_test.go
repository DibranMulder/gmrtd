package document

import (
	"testing"

	cms "github.com/gmrtd/gmrtd/cms"
	"github.com/gmrtd/gmrtd/utils"
)

func TestNewSODNoData(t *testing.T) {
	if sod, err := NewSOD(nil); sod != nil || err != nil {
		t.Errorf("Should be nil when no input data provided")
	}

	if sod, err := NewSOD([]byte{}); sod != nil || err != nil {
		t.Errorf("Should be nil when no input data provided")
	}
}

func TestNewSODUnhappyRootTag(t *testing.T) {
	var sodbytes []byte = utils.HexToBytes("01021234") // valid TLV but invalid SOD, as tag 77 is missing

	sod, err := NewSOD(sodbytes)

	if err == nil {
		t.Errorf("Error expected")
	}

	if sod != nil {
		t.Errorf("SOD not expected for error case")
	}
}

func TestNewSod(t *testing.T) {
	testCases := []struct {
		sodFileBytes      []byte
		expLdsVersion     string
		expUnicodeVersion string
	}{
		// NB expLdsVersion/expUnicodeVersion will be set if latest SOD version is used
		{
			// AT
			sodFileBytes:      utils.HexToBytes("7782064d3082064906092a864886f70d010702a082063a30820636020103310f300d06096086480165030402010500308201120606678108010101a0820106048201023081ff020100300d060960864801650304020105003081ea3025020101042090462cd4824bc24ce1ce77e0e40da503b5f25063e61a78e22c3ac04e49b2024330250201020420113888bddfb89a94522959f3cf41007bb1241e2fdfa585d8f480317eb648215f302502010304205c1c4fa5fd3d90662a92d5c6c7ee94030ae7eed9070a6d8f1db376b268d99f83302502010b04202a1704fa33c5b3a5760eb8b48ff0ff9178e6470dc525b79b13bdcbc95d9d83d5302502010c0420c9673800c44a18a3d6e5300e6ad35ab8737dcdfb9f259e43bcff0c9b6a2d78a9302502010e0420aff8c92133072ed5703a84a5a6f5fe148f02a86b36b2d5876193bd48243cd2f2a08203e3308203df30820366a00302010202086189db18b6ede857300a06082a8648ce3d040303303f310b3009060355040613024154310b3009060355040a0c024756310c300a060355040b0c03424d493115301306035504030c0c435343412d41555354524941301e170d3233303133313038303430325a170d3333303530363038303430325a3054310b3009060355040613024154310b3009060355040a0c024756310c300a060355040b0c03424d49310f300d060355040513063030343031353119301706035504030c1044532d415553545249412d654d525444308201333081ec06072a8648ce3d02013081e0020101302c06072a8648ce3d0101022100a9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377304404207d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9042026dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b60441048bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997022100a9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7020101034200048893905193f315ee2e2f1eee3fd5a496f6637deb3778cfe7cc2f6c7f0682acc795b0290265a2cb83119343544f2bbfe42974159ac77b113dafbee860c2523c06a382015930820155301d0603551d0e04160414e76eaa567acf6568c660c985717c3c8a50bd024b301f0603551d230418301680142692c7e398abfbe35192d3f26e9a317d1fed53bd301a0603551d1004133011810f32303233303530363038303430325a30160603551d20040f300d300b06092a28000a0102010101303e0603551d1f043730353033a031a02f862d687474703a2f2f7777772e626d692e67762e61742f637363612f63726c2f43534341415553545249412e63726c300e0603551d0f0101ff04040302078030370603551d120430302ea410300e310c300a06035504070c03415554861a687474703a2f2f7777772e626d692e67762e61742f637363612f30370603551d110430302ea410300e310c300a06035504070c03415554861a687474703a2f2f7777772e626d692e67762e61742f637363612f301d06076781080101060204123010020100310b1301501302415213024944300a06082a8648ce3d040303036700306402303af7ae31ca6b8fafca6ec51985997f7119fb2e6d20d61b5327d5740109aa310b410bfb44f354e086f207fcab721e69ae023046c68fb7909f994350a2d1c84d1ae5dff8c00de6d86b7891a6cf90ceea09159402e6e2ed3fa548db28d33146319eefda318201213082011d020101304b303f310b3009060355040613024154310b3009060355040a0c024756310c300a060355040b0c03424d493115301306035504030c0c435343412d4155535452494102086189db18b6ede857300d06096086480165030402010500a066301506092a864886f70d01090331080606678108010101301c06092a864886f70d010905310f170d3233303331373133343031385a302f06092a864886f70d01090431220420eb5dd19b9688751461b3e61c9c80f1e848d91eec210048aca6653279c7c37c76300c06082a8648ce3d04030205000446304402202567959c119ee15d14520eab1b527c2bc493253d6733bbec30295af57e3ceb070220614dcea3ba92499e2212b9cd4159758cd49ae240e74b3e20d8d49183ed1feb09"),
			expLdsVersion:     "",
			expUnicodeVersion: "",
		},
		{
			// DE
			sodFileBytes:      utils.HexToBytes("7782070F3082070B06092A864886F70D010702A08206FC308206F8020103310F300D06096086480165030402020500308201120606678108010101A0820106048201023081FF020101300B06096086480165030402023081DC303502010104302DAFFEB0F67656AE099FD655B32F7DC857C31073DF9BC0AF8C9CC783FB40CD9C3FE7503E07421F560ECD7A09B6133D4E303502010204302C65A444298E8A7C1FE51EDE7F2CDD9B8439597330FE142A1996984F841ED3840EE6FEF3475336D29D94012149D9669730350201030430A668251FB0FFDAEF79FEDBD092A296BD808E79FAE546754D0E7F2C9F3F016F23849DD0B7C74A8752DDA554412A8542CD303502010E0430C87AB92F21166AE1059B7D7D995DCE9CDD3E211AECFB943259D88BB2EB8B533B2B5C780251EB5AD21B0A4A8D8A9EE1A2300E1304303130381306303430303030A082049730820493308203F8A003020102020204A8300A06082A8648CE3D0403043041310B3009060355040613024445310D300B060355040A0C0462756E64310C300A060355040B0C036273693115301306035504030C0C637363612D6765726D616E79301E170D3233303130343036303434325A170D3333303730343233353935395A305D310B3009060355040613024445311D301B060355040A0C1442756E646573647275636B6572656920476D6248310C300A060355040513033135323121301F06035504030C18446F63756D656E74205369676E65722050617373706F7274308201B53082014D06072A8648CE3D020130820140020101303C06072A8648CE3D01010231008CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B412B1DA197FB71123ACD3A729901D1A71874700133107EC53306404307BC382C63D8C150C3C72080ACE05AFA0C2BEA28E4FB22787139165EFBA91F90F8AA5814A503AD4EB04A8C7DD22CE2826043004A8C7DD22CE28268B39B55416F0447C2FB77DE107DCD2A62E880EA53EEB62D57CB4390295DBC9943AB78696FA504C110461041D1C64F068CF45FFA2A63A81B7C13F6B8847A3E77EF14FE3DB7FCAFE0CBD10E8E826E03436D646AAEF87B2E247D4AF1E8ABE1D7520F9C2A45CB1EB8E95CFD55262B70B29FEEC5864E19C054FF99129280E4646217791811142820341263C53150231008CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B31F166E6CAC0425A7CF3AB6AF6B7FC3103B883202E9046565020101036200042CA852CB9A1CAAAA466256D1CFD678BB7E5D8502DFA6F3FDB287293C32AF9FA77AD3A7FA92E56F608110053121354002198B530BC60AC7050AB98D7F6C475FD50706A4A6207D7A6336CB480B966A3AA64894F7F42B8FB4AC4774C9D6892330FBA382016430820160301F0603551D23041830168014A40A5FC380AE3E59AF1B32D6136AEFEEC8CA35E8301D0603551D0E04160414AF9DD5E6565737A8804B5B4C6F45093D809AA865300E0603551D0F0101FF040403020780302B0603551D1004243022800F32303233303130343036303434325A810F32303233303730343233353935395A30160603551D20040F300D300B060904007F000703010101302D0603551D1104263024821262756E646573647275636B657265692E6465A40E300C310A300806035504070C014430510603551D12044A30488118637363612D6765726D616E79406273692E62756E642E6465861C68747470733A2F2F7777772E6273692E62756E642E64652F63736361A40E300C310A300806035504070C01443015060767810801010602040A3008020100310313015030300603551D1F042930273025A023A021861F687474703A2F2F7777772E6273692E62756E642E64652F637363615F63726C300A06082A8648CE3D0403040381880030818402404846F4A03E17896E9094AF7652C38FE31EC964C2C3A906AF813AABEF5FE4F3156D140E2EF991DC11FD860A4A301B225DE9FD4ED39B4F47AC72CDB88CC63B335902405D4E2895875E603CE2863073BF441D1EC53761CF47E5BC2B9B6BECE4F229712E39002D77B555290FA550DF5F40AA22D7D2A1E89FEB3FEF730AE33C937796E8E33182012F3082012B02010130473041310B3009060355040613024445310D300B060355040A0C0462756E64310C300A060355040B0C036273693115301306035504030C0C637363612D6765726D616E79020204A8300D06096086480165030402020500A058301506092A864886F70D01090331080606678108010101303F06092A864886F70D01090431320430C194CBC52AAC7A5077E792739434040CCE0C465DDEBF366D64EB3AB8EF5BB457CF5C4BD3D28F69804E5507308DCAE3E8300C06082A8648CE3D0403030500046630640230403C68550DBC310A8002110EE18AEF04E00B119030E0CC3AC8CAD347D87F59031AF26867F1855B1F1555B7C925B92D8A02307185621CD2CDA6051E81627BE5A486EB667897440F5BD69F96B8DD43F4F0B0A0CD21DF376012DBA79D9F7138C2D9B3C7"),
			expLdsVersion:     "0108",
			expUnicodeVersion: "040000",
		},
		{
			// FI
			sodFileBytes:      utils.HexToBytes("7782088c3082088806092a864886f70d010702a082087930820875020103310d300b06096086480165030402033082019b0606678108010101a082018f0482018b30820187020101300b06096086480165030402033082016330450201010440a0b15e7466598ae774aec55d6aa596cb2febf044e0f0a90466249672312f733e3b57eeb116e020caaba0361479c6e1f099c8c8ca0aa24a9139811b5c5a3e031f304502010204401cefc2c48091a24631b32208ee8c3dcbd8e8a4c8aad87a4a46b89121a8617447f83bc5fd0c11cccf0423d4fae2c1954d01c16f5cd43c0b44b58e87faf3baef0f304502010304407fb5cc189137a7455068a1755439beeff0a889ee0b2eb8808bb6e08d28ad39e2eb01009cae80869293e770a0e47fd651c2771f5a6b672bd9952ec3e5db59b90d30450201070440b3430bb89d0fac56e6ff2a77350926b19f69ba517f3052324f41c09b687ed6c11a92114ab28a9291f8de4845441dacc3c403deac385b431de79435162495b431304502010e04401755b7a48d3394aa84e9ff977be9eb9e6e0c9001ea19341b57001e1963e7554136ea6bcd72dbd7f4942ec868cdbc313e9ac888b6d715191e5335e0e7f295b00d300e1304303130381306303430303030a082055a30820556308204bba0030201020204009eb12b300a06082a8648ce3d0403043044310b30090603550406130246493110300e060355040a0c0746696e6c616e64310c300a060355040b0c0356524b3115301306035504030c0c435343412046696e6c616e64301e170d3233303733303032303030305a170d3238313033303231353935395a305b313a303806035504030c314943414f20436f6d706c69616e7420446f63756d656e74205369676e657220666f72204964656e746974792043617264733110300e060355040a0c0746696e6c616e64310b300906035504061302464930820238308201af06072a8648ce3d0201308201a2020101304c06072a8648ce3d0101024100aadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f330818404407830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca04403df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f7230481810481aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f8227dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892024100aadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca9006902010103818200047104ced432749be70d31cc2282ea2d76e63495f3c23c79a45d3c8deb2f5742b0cf807f863b772a9485759d921e83d6e561232770e35a4ab875ec774193ab4eed64aa980bae6853e2fde8d4af7a7310fdf6e0bfbf8a1e546b9ae52531143214b0d24461ffc427da7ab4a40c8cff50a19d050d37007289069a67ffa9bee53fdf5ca38201a13082019d301f0603551d23041830168014d69f6ca7f2e0ab2c5afaf19e697268364d31d393301d0603551d0e04160414843719d5e6ebeab022f12ffdfee6cd0e6544f87d300e0603551d0f0101ff040403020780302b0603551d1004243022800f32303233303733303032303030305a810f32303233313033313231353935395a30160603551d20040f300d300b06092a81768405020a0502304f0603551d1204483046a410300e310c300a06035504070c0346494e8116435343412e46696e6c616e6440676f767365632e6669861a687474703a2f2f7777772e706f6c696973692e66692f6373636130320603551d11042b302981156549442e46696e6c616e6440676f767365632e6669a410300e310c300a06035504070c0346494e306a0603551d1f04633061302da02ba0298627687474703a2f2f70726f78792e66696e6569642e66692f63726c2f6373636166696e632e63726c3030a02ea02c862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f46494e2e63726c3015060767810801010602040a30080201003103130149300a06082a8648ce3d04030403818800308184024025f44a41c77bbc747f0dfd2eed410a2adb6bd9ba2feffe733cdb4d323ed5a300541b373be7859435256ced64b9cbdc1688fcce1b774cc3b00d7d5a0370a7c8f6024043f7198e91f5af185009711b93d37b6c7119f4bed0014605a906fc837d96c70055667f55cba632b0af45c0286ac36584b3072d9893a5da7e9a3b0c2357abd384318201623082015e020101304c3044310b30090603550406130246493110300e060355040a0c0746696e6c616e64310c300a060355040b0c0356524b3115301306035504030c0c435343412046696e6c616e640204009eb12b300b0609608648016503040203a068301506092a864886f70d01090331080606678108010101304f06092a864886f70d01090431420440a3d4fc4488ad552d1d9def987ac4f52b7c8dde70158d2cf2bd131feac6e4476d9e33e6ee25a196009e1c72334c81e50bef1182db529ffd71f9b7bd6191643730300a06082a8648ce3d04030404818730818402404fc84f664786dd227ddfe2667108a4c20ac51e5abcb44c9fcd82027cb63eba4f0a62aacc21b41bae84f8a04d5efcf0daedf5e6e4d9cb1e71a8f128b4779a471602406d87171b1513b7c4234704eb2e8520a1b11c76f624ef74f99374a9b099525de2db4a1c13d1b9e8641787411808065b8a7af910f65fe52f0aaffd08f2b533588c"),
			expLdsVersion:     "0108",
			expUnicodeVersion: "040000",
		},
		{
			// MY
			// RSA-PSS
			sodFileBytes:      utils.HexToBytes("7782098e3082098a06092a864886f70d010702a082097b30820977020103310f300d06096086480165030402010500308201120606678108010101a0820106048201023081ff020100300d060960864801650304020105003081ea3025020101042070d01631abbf347f1fb7ca0b7e8fe6468b84fae853cb7fab2a2e05ef1519c58c30250201020420470beea11e946390967f3521407a29e258179661d6857e8a7d87a5afe9f23cb4302502010304204aea153d17588f1b22a886762789f911abd3ed9017e2d9a150967c70b6c61036302502010b0420a96b4199a460644233ab19cd648edee9c12c520365084356fb5cbb5f962c9024302502010c04206c00c5168e184d6b94129e79d4fbace2a0b4837b7ae196327cf7a8c567085872302502010e042056139d693f679511a91d67585aac748f0b70ca6e14417c1a73f15f205a03cc14a08205d0308205cc30820400a003020102020869ee7da36620dfab304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572301e170d3232303831363039333731345a170d3238303831343039333731345a30819b311c301a06035504030c134d616c617973696120446f63205369676e657231293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f727431233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c6179736961310e300c06035504070c054a6f686f72310e300c06035504080c054a6f686f72310b3009060355040613024d5930820122300d06092a864886f70d01010105000382010f003082010a028201010098153deed15a97298a0190224b91725d0dbd872bc78da1e88b0a0acfc4d74904d2438be7ce7a0876cd4b50c0edfd3337c9278e76f1be9c3469c8ca45a786923eb73c044e2940a4dfe8dee5eb5d9ac46a2297d737a13ab6243418ad2ac2642a5858b79c6d494dcd835d9b8f32eae830c330c375530fb9024126fb050e03ba9c2addacfd7e3df1805c00a8d5aa55811f7f5ebe29cd2442c5e4cbc640468bfdd5b660ef5434e1cba0ad713886ba14acc9ffc3eff47d54b063bb97d2ac19eea1c00d5389b61dd8aeb249e010802d9f2923a56aedf54fd86011a07e89882e84b631588b94dafd3f0d638134ec2bf3335e53162ee1d066f4197f4ec1cc37d252c582db0203010001a38201233082011f301d0603551d0e04160414d63a217ed5886cec8406b8b3f161e0d3dc5379e7301f0603551d23041830168014d54dcf907ed448d2f40e059a3932b4660c9ec2db302e0603551d120427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d59533015060767810801010602040a30080201003103130150302b0603551d1004243022800f32303232303831363039333731345a810f32303233303832363039333731345a303b0603551d1f043430323030a02ea02c862a687474703a2f2f7777772e696d692e676f762e6d792f696d616765732f7064662f636163726c2e63726c300e0603551d0f0101ff040403020780301c0603551d110415301381116a696d706b6940696d692e676f762e6d79304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a20302012003820181004a8caeeb0558a5c763262b003719e0d4cbc90ff6ed105af2793eac441f4a6cee1b78be1f4488e2439163ff5a708e50189a1a7d7fe6868ef7bb6c1dd1554cc322c94cc4f02ee9058c0a77a2a2aa5261a9f4fdfacf9fa68337aeeedfa33cbcf2a789887c1c7932cd59bb473d6a9c8f999819385d6517a2412696110514ab63a58672ddca1db5654a818b6714692008ec8da37793b759c222534f0d63cbacf6e9e8afe60ef70fe69ee9c83125710392c31dba5ed553b879a5b66fa2119ac4ef37dd43902b70dde59073b97ae5b5a111a7df3fcc3f471aa64927ed4adc8feb3d77036d16cb9a24e6692c0df7b4e4ae66b6b65a0f5caf036b4ecc432ef5326f29fa047a386390136a0f618e114a235a4db556dc9fc28f46553df18f315bcd611e8f790135ca5dbcc4cbc128bbe5b185925825558c67637c3f2f2586ae03b3f82238d9058b083d2aa1ebba422f7aa0344614a4f0c182383889097813f0c4b760b44272b1b387de5c4dda19d03a7f636f9e8843df927e04ac3667db6a3d456cadfd919b31820275308202710201013081ad3081a0310b3009060355040613024d5931233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c6179736961310b300906035504080c0257503112301006035504070c0950757472616a61796131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572020869ee7da36620dfab300d06096086480165030402010500a066301506092a864886f70d01090331080606678108010101301c06092a864886f70d010905310f170d3233303132343036313931345a302f06092a864886f70d010904312204202ce83a982160f9753ea1a0d8d82f59c0ec9e40647d0015a702823143989a7eb6304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201200482010096e3cb962a1d8cf79787783bcaa26cd80d2fed9282f97cd1f4a2a64f9170d459dc71e9d9a6f9a9eb259f0ef0bd064d3e17bc4c7bed1eeb4e8b73615f1335e1eab147f6bdd2d510afd3dc09b9dd36eb27db96a76045fa56acecbc1d4d5ce66df2a10d3ed3a9fb41d7c6d221a4568e74d496410c8c024006c7d6a990b2c5c8193b03f45c8a9fe11c17c9367ce7dc13c7813fe1abc9a79df39182bf76ddd6de44717ea6a5d3abcfb4c1c6e617543afa53d12719671590b4f48cd75e7ce79698237f3c589f7b224215fc11e97d19b0bd40c769898dc0701675dddd0bf129b5bfebda4b68d11a96cd073ace5590f63d1dddc2abd0970e6ea95a04792b1af82cc7195f"),
			expLdsVersion:     "",
			expUnicodeVersion: "",
		},
		{
			// NZ
			sodFileBytes:      utils.HexToBytes("77820852308006092A864886F70D010702A0803080020103310F300D0609608648016503040201050030800606678108010101A080048201003081FD020100300B06096086480165030402013081EA30250201010420C34B96088C91A4B07DEEC841D55A886B51E1C7AFD79F058F42171FA498F95F2430250201020420C2BFB7E9B14CE960FE1AC3B455913624D1E1ED4AB92E6E2D20A69EC986116787302502010C0420022FFD5A0A871EC28947EC940FB279FDBCB4B25EF03465E653BCD3DD5C370A5F302502010D0420FDD73AEF84C4F9FC4AB807F2EFADBD013452F1EE7200287ADDED53EDCC5D2BB7302502010E04203C8134CF5A985863519B68BD8FA5EE2EDCAD7C375247393E02D84C0DBD7939D3302502010F0420A5ED6C2A093E548A30F0BEF91AC4C07D12E5733DF252AF1E24FCED0ECE56BF9900000000A0820503308204FF308202E7A003020102020442E57A41300D06092A864886F70D01010B0500306D310B3009060355040613024E5A31223020060355040A0C19476F7665726E6D656E74206F66204E6577205A65616C616E6431123010060355040B0C0950617373706F72747331263024060355040B0C1D4964656E746974792053657276696365732050617373706F7274204341301E170D3137313030313230333935365A170D3238303231323131303030305A307B310B3009060355040613024E5A31223020060355040A0C19476F7665726E6D656E74206F66204E6577205A65616C616E6431123010060355040B0C0950617373706F727473310D300B060355040B0C044D5254443125302306035504030C1C446F63756D656E74205369676E65722032303137313030323030303130820122300D06092A864886F70D01010105000382010F003082010A0282010100C0287BDE6240E37AEC9741D64947758B2BBBCD58A87429442FA6C14EE6481F94D2A221352E663D4C1EAEC896F18C235160D47B548E5B445948C976614D263C6568EA9D08EA504FD930D9775D9CE82A3A834C4EFDE2D6BAB04C499045A3C25DCF29C8E9BA4C58958300C687323066A2AD9EA54C8A23D4AA75DBCAF0AE5CFC8176A94B891AD97C328CA03186C1151D4EB3DCBBCABEF8A9F77F50959BFE30891605A7725BF6DE59240DD1818C6CBD4B71C9A41C8D0A8C77ECA1559B3CA124A09F75BB44178A17E29D5C871DA0DC5A50DAD2873321FDEFE8374ABFE41FB0FC2CC2CB4F255AA5FB3D614B18FEE3FE3346C8E0F9F73DE66348E011A17BE8851C59D3250203010001A38198308195300E0603551D0F0101FF040403020780302B0603551D1004243022800F32303137313030313230333935365A810F32303138303231323131303030305A30160603551D20040F300D300B060960842A65826C010101301F0603551D23041830168014F9D6C969FE97D184EEF2C1D7E520B66032BE3DF7301D0603551D0E0416041424757F42B10EE096409789FFAD2D9150ECFDC5BE300D06092A864886F70D01010B050003820201000D64025FB39BBB1606C76AE6211DD773B0B02675D079EBC3283A8E84C763024471463272B2DC389DB2CB282A0931BC57627B9F4FE774BA031C97F371FA9A50FDB0F363FE85786DDACC3E3264317312BC538116D1664A84B641E8260F23DD6B8D5EB42399B2EA944EE20DAFAA074CAFC9F93FEBAEA4D17C8A2DE3200A335BA3260D594A85D85DB9C5D2391FB9190F4BF30835D1E9965EB22FB35D7E8380A7BD014F9757E4D4934F548D47E35B878FC2C7DC411C01EA54EB33CB0B91EC88D91B67B45C30B021F6D9A866000A80686047C8365B1B81099FCAB5AF3642993498BC8B667812872319ED6395C39D4183C21BC1CD7BFE5381479775AFFA8CE9B2DE8347C4623382320BBE4466D700941175A0802AE0182EC882FF26C5351B754270C3129895A58E659690774C5C175B9903A33FB111D10F856F6D452F3D58A9BCBB414CF3017F803E718470007120C65255AEFFF526A15297B5191A1EBCCEB63680039C5B04D08EA739DF0628EA109B42F87411553FBA2BB4A23F64E012F0C7DFAFB5ED7AFE7DC474F87A741E01A03A09AF84F5E7F5CA15A0114C377F6B0012DF83F9E694E839D190658945BF7014FA69E5CC6AE75C96DD3AB98CE636D9EF42A80D5A24EC3D83C6E1195E2EFCD63B335DBD32717F71858D50998C383291D530F1BF8D5C7ECF674A1F200F989D2589FB6A634666EEB9E33441ABDB060DDF0576420F4D0A31820208308202040201013075306D310B3009060355040613024E5A31223020060355040A0C19476F7665726E6D656E74206F66204E6577205A65616C616E6431123010060355040B0C0950617373706F72747331263024060355040B0C1D4964656E746974792053657276696365732050617373706F7274204341020442E57A41300D06096086480165030402010500A066301506092A864886F70D01090331080606678108010101301C06092A864886F70D010905310F170D3137313131353030333631325A302F06092A864886F70D0109043122042071CB0413DAC76278E04BF30A3DF13AFC0D706E3C95CCE1D16250B6AE3694EEFD300D06092A864886F70D0101010500048201003593195E884103297DFE628DC10230063BCEF6EDF13369499ECE259AE1F70C1A59CCE9F1B444B2F9D12C7C2C877D7BE1B81B61A36827862A596853412D1849CA36E6E5DE095C7A8D505784955AD321CBCCBE7A6F5172BC26E32C9F01C8C5D7CF38CF33AA53A4E174CBC86D5E18A9312A2D5377027A274D002A5AB4F5FEDFB3CC5AF9EB4B7D6158A8BEF16A627BE88058342683699E72B3E2F35F5A7E41451D458AE92A6D26DA693DF4BD4D9D8A498A07323934FB50C9B9BCCA013E98E872937AE3875FBA6665E3B92CF22F33A1087C5CB655724A1FFF183F4BE5980E3BC19A46F9656EF81AD2ED6EE3F0E74DC91EC71C1A82FC1DB4E1ED8DD5EEF9A6361CB849000000000000"),
			expLdsVersion:     "",
			expUnicodeVersion: "",
		},
		{
			// PH
			sodFileBytes:      utils.HexToBytes("7782095E3082095A06092A864886F70D010702A082094B30820947020103310F300D06096086480165030402010500308201120606678108010101A0820106048201023081FF020100300D060960864801650304020105003081EA302502010104206730D98A8FFA85E4043253BD1D22CCAEEA605FBC3701630A0A6D78E5B7112888302502010204208A1DD7AAF89F5422D330D552719823D044F17091250987A03B00CE634F41BE41302502010704204DFF43AA11E6DCEBCC6E1C187B7987C38F4AED160C71CC4103D78711E6060ADC302502010B0420EB46A2387CE76D93B2F57B0190C893A3F363150FB984F701546FF183D1D31855302502010C04202146D2E1AD80677E04C9EEFB7E0E60223A4597023BF230647D514E448B8EA598302502010F04202E10C0E9A1E6F035DF24C220C81B8673F01FEBB7D0A5C80E94BA71BDCC9B69B5A08206133082060F308203C3A003020102020840AD067FA4023A0E304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A203020120302F310B3009060355040613025048310C300A060355040A0C034446413112301006035504030C09435343413031303036301E170D3139313132353136303030305A170D3330303430313135353935395A302D310B3009060355040613025048310C300A060355040A13034446413110300E060355040313074453303130373630820122300D06092A864886F70D01010105000382010F003082010A0282010100D1EFD35613898709BE32888B19BDCA6B59F32A44E69571BC2C607AA4D79AD74B1A3733B3EC8D78FFB1CBFE2F9C799B544E9E0A39CCD47BB0E043F09C4ECBAD089271AF18F28191ED1ACA0D5A4C1646314FA711D5B18CF6C04A212F1062FB3DFA381A748BB29790A166DA9933495CE41B07CA884641449693A3BA131ABFE6F51286BC8E4FA399742C2D047125EC2494C17D575D3BDDDA472263476119B51FD0E1BC5C46C4928C59D4E6D001522EC525A0191821057AE1BAF9EF9426A63577D77917BB97CEC3622C78C1FAED06F659F3BA3A0EBD88DA7698B281D052F845F93098AA644D286F3EB3A1010B6ED6EE4784E7A7260E0ECBCEAD6534750441CCA2B2ED0203010001A38201C7308201C3300E0603551D0F0101FF040403020780301D0603551D0E04160414797455D55B01A403282F3DE09CF06A525865EA72305E0603551D23045730558014E565E5D20737598E3D938FC3581660804399B4E7A133A431302F310B3009060355040613025048310C300A060355040A0C034446413112301006035504030C09435343413031303036820822D9252BFFE6A957302B0603551D1004243022800F32303139313132353136303030305A810F32303230303430313135353935395A30390603551D1104323030811C70617373706F72742E6469726563746F72406466612E676F762E7068A410300E310C300A06035504070C0350484C30390603551D1204323030811C70617373706F72742E6469726563746F72406466612E676F762E7068A410300E310C300A06035504070C0350484C306D0603551D1F046630643030A02EA02C862A68747470733A2F2F706B64646F776E6C6F6164312E6963616F2E696E742F43524C732F50484C2E63726C3030A02EA02C862A68747470733A2F2F706B64646F776E6C6F6164322E6963616F2E696E742F43524C732F50484C2E63726C3020060767810801010602041530131301501302504F130250441302505213025053304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A20302012003820201003E7221D14221DA072B66A06DF3AA5F25AE16D8643CD5B29F4487F45485B1795B15DACF5D4E325239EEE33FBA07BDFF017D0E7F8F14AF31A3F4B497D1390DABA07D9A5C5463A0E3FC0E44500659F1443AD6DB33AE4F93FF9377A7E90CECE5EA3846C51804C0BDE82D836EF5C0CA29FEFB2789B7DEBF5703B1D35B0112809E5A53B6B09DFBA982056B3ECB00E772A942D103EEF9BB8E8B3148A76B08505A01E64593845289C89FB6C78F111810C441EB8D4B2B17639B13B7F94B704BDBB38722513CC823633E3228A7C2E5FEE76264D1DA831354FD2F7171043B6A9398E5FADE72A7BB024EA9AD7CBB3232E72400E7AF39EB86100A036A3311336C40038E0D0AD0109F10107A827B627CDD367454277078B713AEE9AC3B80B65E0BBE995ED0328E266314313AAFA3234A845AF8C4E39F824718E7CD14B726F29DB76B1C57DD5A34526E446F3A54FD570CD228DA79EC65EB47597348D8FB06F1109DC88F09192F65F0894879602F52AFFE0F03550ED04DE061A57D81F6FB3D03FB2F323FC36A9F3CE6F9C57E919205526797E1CB7D46DDD9CE7EA56C87E7C4740FA0B88E52B9E47D54A798888E769419A98C9A6AFA6F9E5B43314A9FC1F849071338E8D64F6FB7DAA45DCE179C72DB8443730B60D20A9CA210C3E6FFA3BEA954114225AC8CB3395E0B3081AC0652D4AC4EE4F86BAC8F1C099614159C761643D3C7024F038F874ADB31820202308201FE020101303B302F310B3009060355040613025048310C300A060355040A0C034446413112301006035504030C09435343413031303036020840AD067FA4023A0E300D06096086480165030402010500A066301506092A864886F70D01090331080606678108010101301C06092A864886F70D010905310F170D3230303230363039313735345A302F06092A864886F70D0109043122042034C8890E17FEA8825214B0C5EBBA4CCEEC2A3D38891865104C22FC86D95A7A6D304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A20302012004820100A4835931B55868D2FA2951918254AA348A0F31F8375508FAFBAA8807100D85478537E97F001012F520A6964B48226D0AA28700667B95EBCA15730680CDA7D44F2A26F53BA18A357F20BD07E2AB6D6D7227CD58150E292BEE1BBFA2F684135A58F7CAE5DEC092166212E2E633706A059CD83EB9FF5F8C996912E2E91C499C606F8AC6FA66AC957B37F89648C061AD1F006E3715CE4DCA3B4C3416D23B53D88A49C30D9AEBAC5D70B0AD73D9821EC912CDAFD89A62E675007F0BB914AE74E19CED2FF6417520614DB6AF6859EEEF9918685D8629F82C3E8B5E59616D17ED89A2BF7ADBBFD07AC648541CA31A9C10CF03D50D2B572C8298F6D8238408EC0C01FA38"),
			expLdsVersion:     "",
			expUnicodeVersion: "",
		},
		{
			// RU
			sodFileBytes:      utils.HexToBytes("778205783082057406092A864886F70D010702A0820565308205610201033109300706052B0E03021A3081A70606678108010101A0819C048199308196020100300706052B0E03021A30818730190201010414D827533C7441E5D1B203D38CB33C47938657E87530190201020414E434F427BEEB2C72166A981DC4A59D7209A4D8F830190201030414C349DEBEF530D52175CA314DA92A44C6C01FD725301902010D0414ED7A89DCDF13764BDA04E00179D8C02AE3291E76301902010E041432807180F407B08D05AC998EDE91F7F157500741A082034830820344308202EBA003020102020200D0300906072A8648CE3D040130818E310B3009060355040613025255310F300D06035504081306527573736961310F300D060355040713064D6F73636F7731173015060355040A130E46535545205354432041746C6173310D300B060355040B1304555A4953311430120603550403130B435343412D527573736961311F301D06092A864886F70D010901161063616D61696C407374636E65742E7275301E170D3139313131333035353135325A170D3331313131303035353135325A308180310B3009060355040613025255310F300D06035504070C064D6F73636F7731123010060355040A0C095354432D41746C6173310D300B060355040B0C04555A4953311C301A06035504030C13446F63756D656E745F5369676E65725F332E33311F301D06092A864886F70D010901161063616D61696C407374636E65742E72753082014B3082010306072A8648CE3D02013081F7020101302C06072A8648CE3D0101022100FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF305B0420FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC04205AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B031504C49D360886E704936A6678E1139D26B7819F7E900441046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5022100FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC6325510201010342000452E2AA04EED2CFECCF391E81870FEF1DE3C5089A0E6691C45CECE028FDFDFDC6ECBD15C92BE84581ED0D9806429CC43E6758D147F6DAAF3B0A1CFAD2902E0BB7A3523050300E0603551D0F0101FF040403020780301D0603551D0E0416041439D649889FE3DD3C0E81F48961B05B0F6FF6ADA5301F0603551D23041830168014850C53F7160E5DEF64A5677CF7C1849205D2B29C300906072A8648CE3D0401034800304502205F86F3E3545E11AC947423B8B542EB69A1FDA07177DF071A7597B06306AB4FD2022100C847125ABC58CC70D1FEBE52DC9439C2FEB0BF8B98182DAF5FEEA497992CEF84318201593082015502010130819530818E310B3009060355040613025255310F300D06035504081306527573736961310F300D060355040713064D6F73636F7731173015060355040A130E46535545205354432041746C6173310D300B060355040B1304555A4953311430120603550403130B435343412D527573736961311F301D06092A864886F70D010901161063616D61696C407374636E65742E7275020200D0300706052B0E03021AA05A301506092A864886F70D01090331080606678108010101301C06092A864886F70D010905310F170D3230303132323037323135385A302306092A864886F70D01090431160414F4346383DB86975F9C6C59F1C3DB73A8B78A6B3B300906072A8648CE3D040104483046022100C31ABEC9E53734A4728FD6017B719BADD4474A3682B9BCEEF591F040F6F074A30221008AE5C38BA1E519F3B1DBCFA62F724ED4603B7C13AAF76F673C0E0E247F1472F2"),
			expLdsVersion:     "",
			expUnicodeVersion: "",
		},
		{
			// SG
			sodFileBytes:      utils.HexToBytes("778209C5308209C106092A864886F70D010702A08209B2308209AE020103310D300B0609608648016503040201308201210606678108010101A0820115048201113082010D020101300B06096086480165030402013081EA30250201010420B8531D522AF781EBBA2F78465B5BEAB1FCCE2861DD947316A217A0F31F06598330250201020420D2FC98EFFEAAC17D42987C48F310315086FC920054F900002DF114A79FF2774B30250201030420883155F3A1EA7948BF4A416625C767ED1F4ED2EAED731F143CC8A22CEABC0CB13025020104042010500F4BC7437F061D4CE735AC0C4F35CF71ADB7C5112AAF9B2CCB2C9BD20C3A302502010D0420ADED95A855D5C0AC69599F46C4C464AD2AAB053798AEBE74C69472FF2FFBB0B4302502010E04209CDA75E7B4F6168E6586CCD175C0AAB3E90F47A68D68E922122937414A90622D300E1304303130381306303430303030A08206603082065C30820410A00302010202045FCDC27C304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A2030201203060310B30090603550406130253473121301F060355040A0C184D696E6973747279206F6620486F6D652041666661697273310C300A060355040B0C034943413120301E06035504030C1753696E6761706F72652050617373706F72742043412035301E170D3232303632373032333934315A170D3332313132373135313232355A305D310B30090603550406130253473121301F060355040A0C184D696E6973747279206F6620486F6D652041666661697273310C300A060355040B0C03494341311D301B06035504030C1453472044534331302032303232303632372D303130820122300D06092A864886F70D01010105000382010F003082010A0282010100A695EF6E7174AA7428B351D0106D1B31D0CBC40E2D2FEFFA6F6DEF30220648C124856C14006C2B961CFF1D81776E3704A00E0BB243CB72F1776B7F6EB917F5A9450C2D1CBB0574ADD7BB8D75FAE7746D6C622CC0A5314BB5812D680077BD45DDF49F58CF7D5D9294CC8045219C8280F8DDDE95B529C9F4AAAE45150252B5C691C46B78FF58DF1F2D7ACE90E14E0920B6E4524E87E596E232F6B80D0BCBBECA94EDB552E4EAAACA21AE6AE56C0F961836C90E198AED563100B49E1BB93497592B2CE6A61A494CF76219B96FA52675A4FA39C6249FC07665564BEC456CDB9217A6FBFA9AF2E043968B51E551CF70861E5BFA5493F3FFE40FF937CF5B55E50135E70203010001A38201B7308201B3300E0603551D0F0101FF0404030207803015060767810801010602040A30080201003103130150301B0603551D1204143012A410300E310C300A06035504070C03534750301B0603551D1104143012A410300E310C300A06035504070C035347503081E20603551D1F0481DA3081D7305CA05AA058862A68747470733A2F2F706B64646F776E6C6F6164312E6963616F2E696E742F43524C732F5347502E63726C862A68747470733A2F2F706B64646F776E6C6F6164322E6963616F2E696E742F43524C732F5347502E63726C3077A075A073A471306F310B30090603550406130253473121301F060355040A0C184D696E6973747279206F6620486F6D652041666661697273310C300A060355040B0C034943413120301E06035504030C1753696E6761706F72652050617373706F72742043412035310D300B06035504030C0443524C31302B0603551D1004243022800F32303232303632373032333934315A810F32303232313132373135313232355A301F0603551D2304183016801484CD5D8A477755058D4EC97E0D4992322BE1C545301D0603551D0E04160414A91A62A686DF680A934C0B68032BFAAA100638A6304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A203020120038202010027186E71CB7F33B78FD28565EB886A8224BAB30752BDE7C53257360C872DE2E89318C14F0BBCBE8B34D08463F504C5AD11E5603B71F3D075B00FBED8FB16E9C5F9E95221783F9463C67F78CC3BD80D6EB8B523DE1C7EAD4C88F4CE3B799A2F60BDC11919FF9A68698686072740F7AB6B60F4958E29C6D7113BA25FEC02A1852783068847476DC313889D5DF2255097067EDC02E97EECBC2B42C8B3072171540320745994C42BF7F3E67E47DC20859C2BA02E722B22568E26BC8429480EC1C95B1F02A14BEA48CC51961AC8DDD35702CA814530D4C8125762655125D67EA6B38570D779EBFD6C3C53636CB65B92F4AE27632C7EB15588A537E1619BD3125F7F80CB80E53DE0C998AFDCF02D07D1FC6DE140C462A9C868742BD8FB256CF2F231A3DB45D54C407D262B4365A5A84CA4243327A31A792F56AE9376C56FC84E63FFC079E85EEC6B866465EED66D95520448D74B09F20E450F4B6B116E85A2BC9C0DEAF6DC0063841E49E8C17478E67F28DB7451D97AF0B82996094808B14A2AD0523D75ECDEC9B1E44FDD44D821591439B13ED851AE532FE70447E6504F455FB9D5F7E4FDA0736D6C3F5895C6A474CDEF2A2213A698E101FFA89D6325C37E0FBABAE6DBA6064FA33479C7C2055C2B245A609A57DE4B254A4ECA9DA97ECB288510F94BE8DCC76520874E76930FFD61AFAD808374C916E3A08B1F2EF6BE8070816109743182020F3082020B02010130683060310B30090603550406130253473121301F060355040A0C184D696E6973747279206F6620486F6D652041666661697273310C300A060355040B0C034943413120301E06035504030C1753696E6761706F72652050617373706F7274204341203502045FCDC27C300B0609608648016503040201A048301506092A864886F70D01090331080606678108010101302F06092A864886F70D01090431220420F990482CF40E723640E3B80910805150E5F5E461FC94C147FB47524D0055445D304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A2030201200482010038D6B5B0DBDCB5CBE3C196613EF5A7311BF391AEA6DED3AACC763AF849AE8D166FA627658F051B18FC119E430B9E1578BF6A9ED5CD6978701FB81D26735D623D835233EA8613E0A96226E048A02BCD776742BB5CB4D97008608B140DF58F15E0900FBE433C0A370F99D77D057F19FEF490297FBD525AF0D8D0F4AC64DB54489009D68FABD416237B2C90C7E98402FF04DAA6CAD7D08933A78D26D2FE111643F1B530DE43DF71AE701EF960B273DF6B0B9A664AA01ED4D601A2C2192185E1E8729C386A89DDB47101DDE606DEEFD8F6815D598601FB6943DA2BB5B044FA034C770DF2529D6379A6D5189328E3C04936833E7BBE9E65DEA4CE103D8494EFADB04F"),
			expLdsVersion:     "0108",
			expUnicodeVersion: "040000",
		},
		{
			// UK
			sodFileBytes:      utils.HexToBytes("778205F4308205F006092A864886F70D010702A08205E1308205DD020103310D300B06096086480165030402013081A80606678108010101A0819D04819A308197020101300B06096086480165030402013075302502010104204BC4557CEB919591EC29A09A7DAD569D6F8FD01CA09D1DD9268ADEC7E81AE33C3025020102042082138F13331D5D689950B7FD60B725639F203D8415877DEB89D3C68DC37E3F62302502010E042002BE33BA93183907394F3392C80C9A4B07988D79B6CA603E2A3DFB2BA2972411300E1304303130381306303430303030A082041C308204183082039DA0030201020204492EFAE1300A06082A8648CE3D0403023041310B3009060355040613024742310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F72697479301E170D3231303230313030303030305A170D3332303630313030303030305A305D310B3009060355040613024742311B3019060355040A1312484D2050617373706F7274204F6666696365310F300D060355040B13064C6F6E646F6E3120301E06035504031317446F63756D656E74205369676E696E67204B6579203332308201333081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF30440420FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC04205AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B0441046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5022100FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC63255102010103420004131A1D896C1DC77DB755369EF5E04E18E096C93AF47F0376D4FDA7A3279467A7AEFF72AF3D6D3ED2CD7E0C8DF96A1755B4C7E273CE7BE98C96BBDB5647723C14A38201893082018530400603551D11043930378123646F63756D656E742E746563686E6F6C6F677940686D706F2E6773692E676F762E756BA410300E310C300A06035504071303474252302B0603551D1004243022800F32303231303230313030303030305A810F32303231303530343030303030305A300E0603551D0F0101FF04040302078030400603551D1204393037A410300E310C300A060355040713034742528123646F63756D656E742E746563686E6F6C6F677940686D706F2E6773692E676F762E756B3019060767810801010602040E300C02010031071301501302505430670603551D1F0460305E305CA05AA058862A68747470733A2F2F706B64646F776E6C6F6164312E6963616F2E696E742F43524C732F4742522E63726C862A68747470733A2F2F706B64646F776E6C6F6164322E6963616F2E696E742F43524C732F4742522E63726C301F0603551D23041830168014DB1D1657C76023089B0139E2613C082134B57CA1301D0603551D0E04160414241401EEFFB0D8FE4D7795F04095099FF989324B300A06082A8648CE3D0403020369003066023100807A00C2CECB43217DBC7085CE19E1825A8E779D6817205B4E1CDB9A29126D0DB39048DB22B4A29AFF40121864BC247C023100A84FE4A9E39C283E0737D4A0278D0802EA0F64993157C7B9885BA0EDEB2943575C53965E340EE6ECC9277F903491AE3F3181FD3081FA02010130493041310B3009060355040613024742310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F726974790204492EFAE1300B0609608648016503040201A048301506092A864886F70D01090331080606678108010101302F06092A864886F70D0109043122042054EE2228A8CEB8FB50C9C115E0B31592B0FC04C637AC5570E7A3E1CA6AD07864300A06082A8648CE3D0403020447304502200DF1170FDD25EF705902A192FAAB5EEDDD1EA0456DF09BCC1E3984A5BEE1B48E0221009033C37718684ED511C240EFA52278D795BC9410A5C2AE9E92B8773346D3D3B6"),
			expLdsVersion:     "0108",
			expUnicodeVersion: "040000",
		},
		{
			// US
			sodFileBytes:      utils.HexToBytes("77820A7730820A7306092A864886F70D010702A0820A6430820A60020103310F300D060960864801650304020105003081C20606678108010101A081B70481B43081B1020100300D0609608648016503040201050030819C302502010104203959D386A57E8CE7E582AEC8C5651C2003AE7634204503F830573350515256FC302502010204203B03FE8D111C545CF4E556AF7364F36731693D5841F539660647190D0420828D302502010B042032DFA16776C6C3CBCCD7BBB05C8B4345CC538C62CE630CD11EBCDE62A26F029D302502010C0420D9B8686DEFD4BBAF96520E077C2B35BB98B5ADD0DC1EA17379FD44B6BEB961FDA082073F3082073B30820523A00302010202045DCDFDE3300D06092A864886F70D01010B05003081A3310B300906035504061302555331183016060355040A0C0F552E532E20476F7665726E6D656E74311C301A060355040B0C134465706172746D656E74206F66205374617465310D300B060355040B0C044D52544431223020060355040B0C1943657274696669636174696F6E20417574686F72697469657331293027060355040B0C20552E532E204465706172746D656E74206F66205374617465204D525444204341301E170D3231303631303230343033365A170D3336313030323038343634355A308189310B300906035504061302555331183016060355040A0C0F552E532E20476F7665726E6D656E74311C301A060355040B0C134465706172746D656E74206F66205374617465310D300B060355040B0C044D52544431193017060355040B0C10446F63756D656E74205369676E6572733118301606035504030C0F44532032303231303631303136343130820122300D06092A864886F70D01010105000382010F003082010A0282010100A5A5964E7B8E9D8C623BDA63760D1406374026D81F21E34F6B06C6F47774D9DF7A0E9D7979BA2C72D4EACC45D1A58A4C5FC20BAD8AE23FDC4024C8E53A8ACDC2B083EC55B63D44D557E048ED1B843CD2B99C147B350C6FB9B67FD02076BEC134C785F4DE58A1AA137196D6FB7EEFD47A03F25996841345A4DAAB7754B047DAB57E5786D54DE5CDE5FAF553F44DE67069F84C2C38E57D0FD13255C814629BAFB2C8932EC8E7029D9EC59D640982F89545E30F22036E0BC58E3E8D4AC8E43C3429BDD9BD545CE6AD1045B28D839169060D93AF72F59BBFA0687C8A90D12BAD51481CC991DF9855DD7AA8FA31250B39AB52563B211362F539A47C167CA496FCBD510203010001A382028D30820289300E0603551D0F0101FF040403020780301C0603551D120415301381116D7274646F70734073746174652E676F763015060767810801010602040A300802010031031301503081990603551D1F04819130818E30818BA08188A08185862A68747470733A2F2F706B64646F776E6C6F6164312E6963616F2E696E742F43524C732F5553412E63726C862A68747470733A2F2F706B64646F776E6C6F6164322E6963616F2E696E742F43524C732F5553412E63726C862B687474703A2F2F63726C732E706B692E73746174652E676F762F63726C732F55534D52544443412E63726C308201190603551D20048201103082010C30820108060A608648016503020106643081F93081F606082B060105050702023081E9301F1618552E532E204465706172746D656E74206F6620537461746530030201011A81C5546869732070617373706F727420616E6420746865206469676974616C206365727469666963617465206F6E2069747320656D626564646564206368697020617265207468652070726F7065727479206F662074686520555320676F7665726E6D656E742E2020416E7920756E617574686F72697A656420757365206F7220617474656D70746564206368616E6765206F72207472616E736665722069732070726F6869626974656420616E64206D61792062652070756E6973686564206279206C61772E301C0603551D110415301381116D7274646F70734073746174652E676F76302B0603551D1004243022800F32303231303631303230343033365A810F32303231313030353038343634355A301F0603551D23041830168014F18A8BFB6A44A3468334D2D592158158824A4CFB301D0603551D0E04160414BBE9FE4B7CF03921F493096F7CC3E8ACBDE3A227300D06092A864886F70D01010B050003820201005473C8793FE0DBA3BD69864F662CC7277F5FF3181C940714309CDEF54896545417B0196599CA534003992AB71F957322257583C13DEF89954C83D963308B5BFAE3598426A70AFE74960F18B2085BBAE961C209BAC961AD3F5542D569191EBE6E352E5483E51C566F949489DB849831668E8DB2ABDFCC2590BCF2B50EFE76B9B125B3BF8591CFD6A35D9382A09C67072F5DC40F973A6DDC03F56A423077C086B95BDF629E444188544569C061B5C44183D825297342B9995FDA4DE15828884F6B767460C785DA6C3042B38399210623C75E06BBA8C63BF33C9A11ED3805BCC7148BC8313246FC40F55AF8CA0AC9307863869AD70A70FD368A7C47B2330E4BFC6D0225279C18240410CEC5A4D873DD8E14D4BA80FF58EF93804277DEA78B8D331525D26CCCF0FFEDB6221B9E7AA54438D15A39058BD36857EEA6060AA9D3A614F4CE8C217A00AF83EE78BE646948141D3BD59E5766E337940105DA2793B36ACE828902A970F78540D8849A48CB43909702AFD2EDAAE82F98D9A9166233944F76D7A92619F48CE4BC085D98209BFFBE729D32681E6E6CEF92D3B41D9417146F4ABEF77EBA98920CAB753C6B88D4D31B1A4D8FC077C2B2615E25FAB9F225B0D62024EC6605C69C1FF55009FF131D0F177AA77C6571FE4491BF13ED8C6FF094B157562253D74C7372F63A17E2CC3A8334134608AE9C66CB5E3B85EF4D5494E7276EED318202403082023C0201013081AC3081A3310B300906035504061302555331183016060355040A0C0F552E532E20476F7665726E6D656E74311C301A060355040B0C134465706172746D656E74206F66205374617465310D300B060355040B0C044D52544431223020060355040B0C1943657274696669636174696F6E20417574686F72697469657331293027060355040B0C20552E532E204465706172746D656E74206F66205374617465204D52544420434102045DCDFDE3300D06096086480165030402010500A066301506092A864886F70D01090331080606678108010101301C06092A864886F70D010905310F170D3231303931363133343530305A302F06092A864886F70D0109043122042026861D5F7C7699780ACAAAA0258E5255217B41A8D9AD797C9716EA755CF0F6CF300D06092A864886F70D0101010500048201003862F39E9140BDE1296F4D4A2B007C03F79D8104D931F85E0F1B7ED54ED2C12C2C548BD167B3CA03BF72E82E28B380B0199D30F2BEF17543892E2A2C9FA17CFCBD1A2DB9900C3052D8C3AB138D870014ECB7EFA4A03775F873EFB96E995871589981B0A6BF06A2897BC41DA92A4D88E3E071CD234AAD569E0EBFDCEE59F065724F3B7087EC328A6DC17538794B79343A194FB91966F4F615F66C2E5B5605803883A87637323E5E9D10D0497E9184C80A6D7CFAD0D77FEA773B487B7A44115650B73241F5AF1AE7EB7D90882C65FEBDD9CE183C93B6589F521A948C5E3994BFE09266C95E0BD9DDE4B297B2613B6FF75D52087C112AA8291C3D2AD7F3E5A39233"),
			expLdsVersion:     "",
			expUnicodeVersion: "",
		},
	}
	for _, tc := range testCases {
		sod, err := NewSOD(tc.sodFileBytes)

		if err != nil {
			t.Errorf("Unexpected error: %s", err)
		}

		if sod == nil {
			t.Errorf("SOD expected")
			break
		}

		if sod.ldsVersion() != tc.expLdsVersion {
			t.Errorf("LDS Version differs to expected (exp:%s, act:%s)", tc.expLdsVersion, sod.ldsVersion())
		}

		if sod.unicodeVersion() != tc.expUnicodeVersion {
			t.Errorf("Unicode Version differs to expected (exp:%s, act:%s)", tc.expUnicodeVersion, sod.unicodeVersion())
		}

		{
			// get the CSCA certificate pool
			var cscaCertPool *cms.CertPool = cms.CscaCertPool()

			var certChain [][]byte

			certChain, err = sod.SD.SD2.Verify(cscaCertPool)
			if err != nil {
				t.Errorf("Error verifying SignedData: %s", err)
			}

			if len(certChain) != 2 {
				// TODO - could do a deeper check of the returns certs (inc ordering)
				t.Errorf("Cert chain should have 2 certs")
			}
		}
	}
}
